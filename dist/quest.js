var Fo=Object.defineProperty;var To=(t,e,n)=>e in t?Fo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var An=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var vi=(t,e,n)=>(To(t,typeof e!="symbol"?e+"":e,n),n);var Xi=An((rs,kr)=>{kr.exports={}});var oo=An((us,Ir)=>{Ir.exports={}});var co=An((gs,jr)=>{jr.exports={}});var bo=An((Ss,Or)=>{Or.exports={}});var ko=An((Qs,ua)=>{ua.exports={}});var Xn=["String","Number","Boolean","Formula","Resource"];var ie=class{static getAttributeData(e){for(let i of Object.values(e.data.attributes))i.dtype&&(i.isCheckbox=i.dtype==="Boolean",i.isResource=i.dtype==="Resource",i.isFormula=i.dtype==="Formula");e.data.ungroupedAttributes={};let n=e.data.groups||{},l=Object.keys(n).sort((i,r)=>{let o=n[i].label??i,s=n[r].label??r;return o.localeCompare(s)});for(let i of l){let r=e.data.attributes[i]||{};e.data.groups[i].attributes||(e.data.groups[i].attributes={}),Object.keys(r).sort((o,s)=>o.localeCompare(s)).forEach(o=>{typeof r[o]!="object"||!r[o]||(r[o].isCheckbox=r[o].dtype==="Boolean",r[o].isResource=r[o].dtype==="Resource",r[o].isFormula=r[o].dtype==="Formula",e.data.groups[i].attributes[o]=r[o])})}Object.keys(e.data.attributes).filter(i=>!l.includes(i)).sort((i,r)=>i.localeCompare(r)).forEach(i=>{e.data.ungroupedAttributes[i]=e.data.attributes[i]}),e.items&&e.items.forEach(i=>{for(let[r,o]of Object.entries(i.data.attributes))if(o.dtype)o.label||(o.label=r),o.dtype==="Formula"?o.isFormula=!0:o.isFormula=!1;else for(let[s,a]of Object.entries(o))a.dtype&&(a.label||(a.label=s),a.dtype==="Formula"?a.isFormula=!0:a.isFormula=!1)})}static onSubmit(e){if(e.currentTarget){if(e.currentTarget.tagName.toLowerCase()==="input"&&!e.currentTarget.hasAttribute("name"))return!1;let n=!1,l=e.currentTarget;if(l.classList.contains("attribute-key")){let i=l.value,r=l.closest(".attribute").dataset.attribute,o=!1,s=document.querySelectorAll(".group-key");for(let a=0;a<s.length;a++)if(s[a].value===i){ui.notifications.error(game.i18n.localize("QUEST.NotifyAttrDuplicate")+` (${i})`),l.value=r,o=!0;break}o||(r=r.includes(".")?r.split(".")[1]:r,n=$(l).attr("name").replace(r,i))}return n||!0}}static async onClickAttributeControl(e){switch(e.preventDefault(),e.currentTarget.dataset.action){case"create":return ie.createAttribute(e,this);case"delete":return ie.deleteAttribute(e,this)}}static async onClickAttributeGroupControl(e){switch(e.preventDefault(),e.currentTarget.dataset.action){case"create-group":return ie.createAttributeGroup(e,this);case"delete-group":return ie.deleteAttributeGroup(e,this)}}static onAttributeRoll(e){e.preventDefault();let n=e.currentTarget,i=n.closest(".attribute").querySelector(".attribute-label")?.value??n.parentElement.querySelector(".attribute-key").value,r=game.settings.get("quest","macroShorthand"),o=this.actor.getRollData(),s=n.closest(".attribute").querySelector(".attribute-value")?.value;if(s){let a=null;if(s.includes("@item.")&&this.item){let u=this.item.name.slugify({strict:!0});a=r?`@items.${u}.`:`@items.${u}.attributes.`,s=s.replace("@item.",a)}return new Roll(s,o).toMessage({user:game.user.id,speaker:ChatMessage.getSpeaker({actor:this.actor}),flavor:`${i}`})}}static getAttributeHtml(e,n,l=!1){let i='<div style="display: none;">';for(let[r,o]of Object.entries(e))i=i+`<input type="${o.type}" name="data.attributes${l?"."+l:""}.attr${n}.${r}" value="${o.value}"/>`;return i+"</div>"}static validateGroup(e,n){let l=Object.keys(n.data.data.groups||{}),i=Object.keys(n.data.data.attributes).filter(r=>!l.includes(r));return l.includes(e)?(ui.notifications.error(game.i18n.localize("QUEST.NotifyGroupDuplicate")+` (${e})`),!1):i.includes(e)?(ui.notifications.error(game.i18n.localize("QUEST.NotifyGroupAttrDuplicate")+` (${e})`),!1):e.match(/[\s|\.]/i)?(ui.notifications.error(game.i18n.localize("QUEST.NotifyGroupAlphanumeric")),!1):!0}static async createAttribute(e,n){let l=e.currentTarget,i=l.dataset.group,r=l.dataset.dtype,o=n.object.data.data.attributes,s=n.object.data.data.groups,a=n.form,f=Object.keys(o).filter(C=>!Object.keys(s).includes(C)),u=Object.keys(o).length+1,d=`attr${u}`,p=document.createElement("div");for(;f.includes(d);)++u,d=`attr${u}`;let y={key:{type:"text",value:d}};if(i){for(f=o[i]?Object.keys(o[i]):[],u=f.length+1,d=`attr${u}`;f.includes(d);)++u,d=`attr${u}`;y.key.value=d,y.group={type:"hidden",value:i},y.dtype={type:"hidden",value:r}}else if(!r){let C=document.querySelector(".attributes > .attributes-group .attribute:last-child .attribute-dtype")?.value;r=C||"String",y.dtype={type:"hidden",value:r}}p.innerHTML=ie.getAttributeHtml(y,u,i),p=p.children[0],a.appendChild(p),await n._onSubmit(e)}static async deleteAttribute(e,n){let i=e.currentTarget.closest(".attribute");i&&(i.parentElement.removeChild(i),await n._onSubmit(e))}static async createAttributeGroup(e,n){let l=e.currentTarget,i=n.form,r=$(l).siblings(".group-prefix").val();if(r.length>0&&ie.validateGroup(r,n.object)){let o=document.createElement("div");o.innerHTML=`<input type="text" name="data.groups.${r}.key" value="${r}"/>`,o=o.children[0],i.appendChild(o),await n._onSubmit(e)}}static async deleteAttributeGroup(e,n){let i=e.currentTarget.closest(".group-header"),r=i.closest(".group"),o=$(i).find(".group-key");new Dialog({title:game.i18n.localize("QUEST.DeleteGroup"),content:`${game.i18n.localize("QUEST.DeleteGroupContent")} <strong>${o.val()}</strong>`,buttons:{confirm:{icon:'<i class="fas fa-trash"></i>',label:game.i18n.localize("Yes"),callback:async()=>{r.parentElement.removeChild(r),await n._onSubmit(e)}},cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("No")}}}).render(!0)}static updateAttributes(e,n){let l=[],i=foundry.utils.expandObject(e)?.data?.attributes||{},r=Object.values(i).reduce((o,s)=>{let a=[],f=null;if(!s.key)a=Object.keys(s),a.forEach(u=>{f=s[u].group,l.push(f);let d=s[u],p=s[u].key?s[u].key.trim():u.trim();if(/[\s\.]/.test(p))return ui.notifications.error("Attribute keys may not contain spaces or periods");delete d.key,o[f]||(o[f]={}),o[f][p]=d});else{let u=s.key.trim();if(/[\s\.]/.test(u))return ui.notifications.error("Attribute keys may not contain spaces or periods");delete s.key,f||(o[u]=s)}return o},{});for(let o of Object.keys(n.data.data.attributes))r.hasOwnProperty(o)||(r[`-=${o}`]=null);for(let o of l)if(n.data.data.attributes[o])for(let s of Object.keys(n.data.data.attributes[o]))r[o].hasOwnProperty(s)||(r[o][`-=${s}`]=null);return e=Object.entries(e).filter(o=>!o[0].startsWith("data.attributes")).reduce((o,s)=>(o[s[0]]=s[1],o),{_id:n.id,"data.attributes":r}),e}static updateGroups(e,n){let l=expandObject(e).data.groups||{},i=Object.values(l).reduce((r,o)=>{Array.isArray(o.key)&&(o.key=o.key[0]);let s=o.key.trim();return/[\s\.]/.test(s)?ui.notifications.error("Group keys may not contain spaces or periods"):(delete o.key,r[s]=o,r)},{});for(let r of Object.keys(n.data.data.groups))i.hasOwnProperty(r)||(i[`-=${r}`]=null);return e=Object.entries(e).filter(r=>!r[0].startsWith("data.groups")).reduce((r,o)=>(r[o[0]]=o[1],r),{_id:n.id,"data.groups":i}),e}static async createDialog(e={},n={}){let l=this.metadata.name,i=game.folders.filter(p=>p.data.type===l&&p.displayed),r=game.i18n.localize(this.metadata.label),o=game.i18n.format("ENTITY.Create",{entity:r}),s=game.collections.get(this.documentName),a=s.filter(p=>p.getFlag("quest","isTemplate")),u={[this.metadata.types[0]]:game.i18n.localize("QUEST.NoTemplate")};for(let p of a)u[p.id]=p.name;let d=await renderTemplate("templates/sidebar/entity-create.html",{name:e.name||game.i18n.format("ENTITY.New",{entity:r}),folder:e.folder,folders:i,hasFolders:i.length>1,type:e.type||a[0]?.id||"",types:u,hasTypes:!0});return Dialog.prompt({title:o,content:d,label:o,callback:p=>{let y=p[0].querySelector("form"),I=new FormDataExtended(y).toObject(),G=s.get(y.type.value);return G&&(I=foundry.utils.mergeObject(G.toObject(),I),I.type=G.data.type,delete I.flags.quest.isTemplate),I=foundry.utils.mergeObject(I,e),this.create(I,{renderSheet:!0})},rejectClose:!1,options:n})}};var xn=class extends Actor{prepareDerivedData(){super.prepareDerivedData(),this.data.data.groups=this.data.data.groups||{},this.data.data.attributes=this.data.data.attributes||{}}prepareData(){return super.prepareData(),this.data.type=="character"&&this._prepareCharacterData(this.data),this.data}_prepareCharacterData(e){e.data.itemTypes=this.itemTypes;let n=this.itemTypes.ability,l={};for(let i of n)l[i.data.data.path]||(l[i.data.data.path]=[]),l[i.data.data.path].push(i);return e.data.abilityTypes=l,e}async _preCreate(e,n,l){await super._preCreate(e,n,l)}getRollData(){let e=this.toObject(!1).data,n=game.settings.get("quest","macroShorthand"),l=[],i=[];return this._applyShorthand(e,l,n),this._applyItems(e,i,n),this._applyItemsFormulaReplacements(e,i,n),this._applyFormulaReplacements(e,l,n),n&&(delete e.attributes,delete e.attr,delete e.abil,delete e.groups),e}_applyShorthand(e,n,l){for(let[i,r]of Object.entries(e.attributes||{}))if(r.dtype==="Formula"&&n.push(i),l&&!(i in e))if(r.dtype)e[i]=r.value;else{e[i]={};for(let[o,s]of Object.entries(r))e[i][o]=s.value,s.dtype==="Formula"&&n.push(`${i}.${o}`)}}_applyItems(e,n,l){e.items=this.items.reduce((i,r)=>{let o=r.name.slugify({strict:!0}),s=r.toObject(!1).data;for(let[a,f]of Object.entries(s.attributes))if(f.dtype==="Formula"&&n.push(`${o}..${a}`),l){if(!(a in s))if(f.dtype)s[a]=f.value;else{s[a]||(s[a]={});for(let[u,d]of Object.entries(f))s[a][u]=d.value,d.dtype==="Formula"&&n.push(`${o}..${a}.${u}`)}}else if(!f.dtype){s[a]||(s[a]={});for(let[u,d]of Object.entries(f))s[a][u]=d.value,d.dtype==="Formula"&&n.push(`${o}..${a}.${u}`)}return l&&delete s.attributes,i[o]=s,i},{})}_applyItemsFormulaReplacements(e,n,l){for(let i of n){let r=null,o=i.split("..");r=o[0],i=o[1];let s=null;if(i.includes(".")){let f=i.split(".");i=f[0],s=f[1]}let a="";l?e.items[r][i][s]?(a=e.items[r][i][s].replace("@item.",`@items.${r}.`),e.items[r][i][s]=Roll.replaceFormulaData(a,e)):e.items[r][i]&&(a=e.items[r][i].replace("@item.",`@items.${r}.`),e.items[r][i]=Roll.replaceFormulaData(a,e)):e.items[r].attributes[i][s]?(a=e.items[r].attributes[i][s].value.replace("@item.",`@items.${r}.attributes.`),e.items[r].attributes[i][s].value=Roll.replaceFormulaData(a,e)):e.items[r].attributes[i].value&&(a=e.items[r].attributes[i].value.replace("@item.",`@items.${r}.attributes.`),e.items[r].attributes[i].value=Roll.replaceFormulaData(a,e))}}_applyFormulaReplacements(e,n,l){for(let i of n){let r=null;if(i.includes(".")){let o=i.split(".");i=o[0],r=o[1]}e.attributes[i]?.value?e.attributes[i].value=Roll.replaceFormulaData(e.attributes[i].value,e):r&&(e.attributes[i][r].value=Roll.replaceFormulaData(e.attributes[i][r].value,e)),l&&(e.attributes[i]?.value?e[i]=e.attributes[i].value:r&&(e[i]||(e[i]={}),e[i][r]=e.attributes[i][r].value))}}};var Sl=class extends Item{prepareDerivedData(){if(super.prepareDerivedData(),this.data.data.groups=this.data.data.groups||{},this.data.data.attributes=this.data.data.attributes||{},this.data.type=="ability"){let n=String(this.data.data.description).toLowerCase(),i=new RegExp("@(cost|Cost)\\[([^\\]]+)\\](?:{([^}]+)})?","g").exec(n);if(this.data.data.cost=0,i){this.data.data.cost=i[2];var e=(n.match(/@cost/g)||[]).length;e>1&&(this.data.data.cost=i[2]+"+")}}}};var Fl=class extends ItemSheet{static get defaultOptions(){return foundry.utils.mergeObject(super.defaultOptions,{classes:["quest","sheet","item"],template:"systems/quest/templates/item-sheet.html",width:520,height:480,tabs:[{navSelector:".sheet-tabs",contentSelector:".sheet-body",initial:"description"}],scrollY:[".attributes"]})}getData(){let e=super.getData();return ie.getAttributeData(e.data),e.systemData=e.data.data,e.dtypes=Xn,e}activateListeners(e){super.activateListeners(e),!!this.isEditable&&(e.find(".attributes").on("click",".attribute-control",ie.onClickAttributeControl.bind(this)),e.find(".groups").on("click",".group-control",ie.onClickAttributeGroupControl.bind(this)),e.find(".attributes").on("click","a.attribute-roll",ie.onAttributeRoll.bind(this)),e.find(".attributes a.attribute-roll").each((n,l)=>{l.setAttribute("draggable",!0),l.addEventListener("dragstart",i=>{let r=i.currentTarget.dataset;i.dataTransfer.setData("text/plain",JSON.stringify(r))},!1)}))}_getSubmitData(e){let n=super._getSubmitData(e);return n=ie.updateAttributes(n,this.object),n=ie.updateGroups(n,this.object),n}};var Tl=class extends ItemSheet{static get defaultOptions(){return foundry.utils.mergeObject(super.defaultOptions,{classes:["quest","sheet","item"],template:"systems/quest/templates/ability-sheet.html",width:520,height:480,tabs:[{navSelector:".sheet-tabs",contentSelector:".sheet-body",initial:"description"}],scrollY:[".attributes"]})}getData(){let e=super.getData();return ie.getAttributeData(e.data),e.systemData=e.data.data,e.dtypes=Xn,e}activateListeners(e){super.activateListeners(e),!!this.isEditable&&(e.find(".attributes").on("click",".attribute-control",ie.onClickAttributeControl.bind(this)),e.find(".groups").on("click",".group-control",ie.onClickAttributeGroupControl.bind(this)),e.find(".attributes").on("click","a.attribute-roll",ie.onAttributeRoll.bind(this)),e.find(".attributes a.attribute-roll").each((n,l)=>{l.setAttribute("draggable",!0),l.addEventListener("dragstart",i=>{let r=i.currentTarget.dataset;i.dataTransfer.setData("text/plain",JSON.stringify(r))},!1)}))}_getSubmitData(e){let n=super._getSubmitData(e);return n=ie.updateAttributes(n,this.object),n=ie.updateGroups(n,this.object),n}};function O(){}function El(t){return t()}function ki(){return Object.create(null)}function $e(t){t.forEach(El)}function bn(t){return typeof t=="function"}function et(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function wi(t){return Object.keys(t).length===0}function yn(t,...e){if(t==null)return O;let n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function On(t,e,n){t.$$.on_destroy.push(yn(e,n))}function vn(t){return t??""}var Aa=typeof window!="undefined";var Oa=new Set;var $n=!1;function Eo(){$n=!0}function jo(){$n=!1}function Do(t,e,n,l){for(;t<e;){let i=t+(e-t>>1);n(i)<=l?t=i+1:e=i}return t}function Ao(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes,n=new Int32Array(e.length+1),l=new Int32Array(e.length);n[0]=-1;let i=0;for(let a=0;a<e.length;a++){let f=e[a].claim_order,u=Do(1,i+1,p=>e[n[p]].claim_order,f)-1;l[a]=n[u]+1;let d=u+1;n[d]=a,i=Math.max(d,i)}let r=[],o=[],s=e.length-1;for(let a=n[i]+1;a!=0;a=l[a-1]){for(r.push(e[a-1]);s>=a;s--)o.push(e[s]);s--}for(;s>=0;s--)o.push(e[s]);r.reverse(),o.sort((a,f)=>a.claim_order-f.claim_order);for(let a=0,f=0;a<o.length;a++){for(;f<r.length&&o[a].claim_order>=r[f].claim_order;)f++;let u=f<r.length?r[f]:null;t.insertBefore(o[a],u)}}function m(t,e){$n?(Ao(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function j(t,e,n){$n&&!n?m(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function E(t){t.parentNode&&t.parentNode.removeChild(t)}function Ut(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function F(t){return document.createTextNode(t)}function D(){return F(" ")}function ln(){return F("")}function De(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function h(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Oo(t){return Array.from(t.childNodes)}function ee(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function kn(t,e,n,l){t.style.setProperty(e,n,l?"important":"")}var Na=new Set;var el;function tl(t){el=t}function Ci(){if(!el)throw new Error("Function called outside component initialization");return el}function Nn(t,e){Ci().$$.context.set(t,e)}function wn(t){return Ci().$$.context.get(t)}var Mn=[];var Ae=[],nl=[],jl=[],No=Promise.resolve(),Dl=!1;function Mo(){Dl||(Dl=!0,No.then(Ii))}function ll(t){nl.push(t)}function tt(t){jl.push(t)}var Al=!1,Ol=new Set;function Ii(){if(!Al){Al=!0;do{for(let t=0;t<Mn.length;t+=1){let e=Mn[t];tl(e),qo(e.$$)}for(tl(null),Mn.length=0;Ae.length;)Ae.pop()();for(let t=0;t<nl.length;t+=1){let e=nl[t];Ol.has(e)||(Ol.add(e),e())}nl.length=0}while(Mn.length);for(;jl.length;)jl.pop()();Dl=!1,Al=!1,Ol.clear()}}function qo(t){if(t.fragment!==null){t.update(),$e(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ll)}}var il=new Set,on;function ve(){on={r:0,c:[],p:on}}function ke(){on.r||$e(on.c),on=on.p}function A(t,e){t&&t.i&&(il.delete(t),t.i(e))}function M(t,e,n,l){if(t&&t.o){if(il.has(t))return;il.add(t),on.c.push(()=>{il.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}}var Ma=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var qa=new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);function nt(t,e,n){let l=t.$$.props[e];l!==void 0&&(t.$$.bound[l]=n,n(t.$$.ctx[l]))}function we(t){t&&t.c()}function _e(t,e,n,l){let{fragment:i,on_mount:r,on_destroy:o,after_update:s}=t.$$;i&&i.m(e,n),l||ll(()=>{let a=r.map(El).filter(bn);o?o.push(...a):$e(a),t.$$.on_mount=[]}),s.forEach(ll)}function de(t,e){let n=t.$$;n.fragment!==null&&($e(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Lo(t,e){t.$$.dirty[0]===-1&&(Mn.push(t),Mo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function mt(t,e,n,l,i,r,o=[-1]){let s=el;tl(t);let a=t.$$={fragment:null,ctx:null,props:r,update:O,not_equal:i,bound:ki(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:e.context||[]),callbacks:ki(),dirty:o,skip_bound:!1},f=!1;if(a.ctx=n?n(t,e.props||{},(u,d,...p)=>{let y=p.length?p[0]:d;return a.ctx&&i(a.ctx[u],a.ctx[u]=y)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](y),f&&Lo(t,u)),d}):[],a.update(),f=!0,$e(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){Eo();let u=Oo(e.target);a.fragment&&a.fragment.l(u),u.forEach(E)}else a.fragment&&a.fragment.c();e.intro&&A(t.$$.fragment),_e(t,e.target,e.anchor,e.customElement),jo(),Ii()}tl(s)}var Ro;typeof HTMLElement=="function"&&(Ro=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(El).filter(bn);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){$e(this.$$.on_disconnect)}$destroy(){de(this,1),this.$destroy=O}$on(t,e){let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let l=n.indexOf(e);l!==-1&&n.splice(l,1)}}$set(t){this.$$set&&!wi(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var ut=class{$destroy(){de(this,1),this.$destroy=O}$on(e,n){let l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{let i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!wi(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Cn=[];function ol(t,e=O){let n,l=[];function i(s){if(et(t,s)&&(t=s,n)){let a=!Cn.length;for(let f=0;f<l.length;f+=1){let u=l[f];u[1](),Cn.push(u,t)}if(a){for(let f=0;f<Cn.length;f+=2)Cn[f][0](Cn[f+1]);Cn.length=0}}}function r(s){i(s(t))}function o(s,a=O){let f=[s,a];return l.push(f),l.length===1&&(n=e(i)||O),s(t),()=>{let u=l.indexOf(f);u!==-1&&l.splice(u,1),l.length===0&&(n(),n=null)}}return{set:i,update:r,subscribe:o}}function Nl(){}function Po(t,e){for(let n in e)t[n]=e[n];return t}function Si(t){return t()}function Fi(){return Object.create(null)}function rn(t){t.forEach(Si)}function Ti(t){return typeof t=="function"}function Bo(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Qo(t){return Object.keys(t).length===0}function qn(t,e,n,l){if(t){let i=Ei(t,e,n,l);return t[0](i)}}function Ei(t,e,n,l){return t[1]&&l?Po(n.ctx.slice(),t[1](l(e))):n.ctx}function Go(t,e,n,l){if(t[2]&&l){let i=t[2](l(n));if(e.dirty===void 0)return i;if(typeof i=="object"){let r=[],o=Math.max(e.dirty.length,i.length);for(let s=0;s<o;s+=1)r[s]=e.dirty[s]|i[s];return r}return e.dirty|i}return e.dirty}function Ln(t,e,n,l,i,r,o){let s=Go(e,l,i,r);if(s){let a=Ei(e,n,l,o);t.p(a,s)}}function me(t,e){t.appendChild(e)}function X(t,e,n){t.insertBefore(e,n||null)}function W(t){t.parentNode.removeChild(t)}function Ml(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function ge(t){return document.createElement(t)}function pt(t){return document.createTextNode(t)}function Kt(){return pt(" ")}function Yt(){return pt("")}function lt(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function Uo(t){return function(e){return e.preventDefault(),t.call(this,e)}}function P(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ko(t){return Array.from(t.childNodes)}function an(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function ji(t,e){t.value=e??""}function In(t,e,n){t.classList[n?"add":"remove"](e)}var ql=class{constructor(e=null){this.a=e,this.e=this.n=null}m(e,n,l=null){this.e||(this.e=ge(n.nodeName),this.t=n,this.h(e)),this.i(l)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)X(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(W)}},Di;function rl(t){Di=t}var Rn=[],al=[],sl=[],Ai=[],Yo=Promise.resolve(),Ll=!1;function Vo(){Ll||(Ll=!0,Yo.then(Oi))}function Rl(t){sl.push(t)}var zl=!1,Hl=new Set;function Oi(){if(!zl){zl=!0;do{for(let t=0;t<Rn.length;t+=1){let e=Rn[t];rl(e),Wo(e.$$)}for(rl(null),Rn.length=0;al.length;)al.pop()();for(let t=0;t<sl.length;t+=1){let e=sl[t];Hl.has(e)||(Hl.add(e),e())}sl.length=0}while(Rn.length);for(;Ai.length;)Ai.pop()();Ll=!1,zl=!1,Hl.clear()}}function Wo(t){if(t.fragment!==null){t.update(),rn(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Rl)}}var ul=new Set,sn;function Sn(){sn={r:0,c:[],p:sn}}function Fn(){sn.r||rn(sn.c),sn=sn.p}function te(t,e){t&&t.i&&(ul.delete(t),t.i(e))}function Ce(t,e,n,l){if(t&&t.o){if(ul.has(t))return;ul.add(t),sn.c.push(()=>{ul.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}}function Jo(t,e,n,l){let{fragment:i,on_mount:r,on_destroy:o,after_update:s}=t.$$;i&&i.m(e,n),l||Rl(()=>{let a=r.map(Si).filter(Ti);o?o.push(...a):rn(a),t.$$.on_mount=[]}),s.forEach(Rl)}function Zo(t,e){let n=t.$$;n.fragment!==null&&(rn(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Xo(t,e){t.$$.dirty[0]===-1&&(Rn.push(t),Vo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function xo(t,e,n,l,i,r,o=[-1]){let s=Di;rl(t);let a=t.$$={fragment:null,ctx:null,props:r,update:Nl,not_equal:i,bound:Fi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:e.context||[]),callbacks:Fi(),dirty:o,skip_bound:!1},f=!1;if(a.ctx=n?n(t,e.props||{},(u,d,...p)=>{let y=p.length?p[0]:d;return a.ctx&&i(a.ctx[u],a.ctx[u]=y)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](y),f&&Xo(t,u)),d}):[],a.update(),f=!0,rn(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){let u=Ko(e.target);a.fragment&&a.fragment.l(u),u.forEach(W)}else a.fragment&&a.fragment.c();e.intro&&te(t.$$.fragment),Jo(t,e.target,e.anchor,e.customElement),Oi()}rl(s)}var Ni=class{$destroy(){Zo(this,1),this.$destroy=Nl}$on(e,n){let l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{let i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!Qo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};function $o(){var t=ge("style");t.id="svelte-lduj97-style",t.textContent='.autocomplete.svelte-lduj97.svelte-lduj97{min-width:200px;display:inline-block;max-width:100%;position:relative;vertical-align:top;height:2.25em}.autocomplete.svelte-lduj97.svelte-lduj97:not(.hide-arrow):not(.is-loading)::after{border:3px solid transparent;border-radius:2px;border-right:0;border-top:0;content:" ";display:block;height:0.625em;margin-top:-0.4375em;pointer-events:none;position:absolute;top:50%;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:center;transform-origin:center;width:0.625em;border-color:#3273dc;right:1.125em;z-index:4}.autocomplete.show-clear.svelte-lduj97.svelte-lduj97:not(.hide-arrow)::after{right:2.3em}.autocomplete.svelte-lduj97 .svelte-lduj97{box-sizing:border-box}.autocomplete-input.svelte-lduj97.svelte-lduj97{font:inherit;width:100%;height:100%;padding:5px 11px}.autocomplete.svelte-lduj97:not(.hide-arrow) .autocomplete-input.svelte-lduj97{padding-right:2em}.autocomplete.show-clear.svelte-lduj97:not(.hide-arrow) .autocomplete-input.svelte-lduj97{padding-right:3.2em}.autocomplete.hide-arrow.show-clear.svelte-lduj97 .autocomplete-input.svelte-lduj97{padding-right:2em}.autocomplete-list.svelte-lduj97.svelte-lduj97{background:#fff;position:relative;width:100%;overflow-y:auto;z-index:99;padding:10px 0;top:0px;border:1px solid #999;max-height:calc(15 * (1rem + 10px) + 15px);user-select:none}.autocomplete-list.svelte-lduj97.svelte-lduj97:empty{padding:0}.autocomplete-list-item.svelte-lduj97.svelte-lduj97{padding:5px 15px;color:#333;cursor:pointer;line-height:1}.autocomplete-list-item.confirmed.svelte-lduj97.svelte-lduj97{background-color:#789fed;color:#fff}.autocomplete-list-item.selected.svelte-lduj97.svelte-lduj97{background-color:#2e69e2;color:#fff}.autocomplete-list-item-no-results.svelte-lduj97.svelte-lduj97{padding:5px 15px;color:#999;line-height:1}.autocomplete-list-item-create.svelte-lduj97.svelte-lduj97{padding:5px 15px;line-height:1}.autocomplete-list-item-loading.svelte-lduj97.svelte-lduj97{padding:5px 15px;line-height:1}.autocomplete-list.hidden.svelte-lduj97.svelte-lduj97{display:none}.autocomplete.show-clear.svelte-lduj97 .autocomplete-clear-button.svelte-lduj97{cursor:pointer;display:block;text-align:center;position:absolute;right:0.1em;padding:0.3em 0.6em;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);z-index:4}.autocomplete.svelte-lduj97:not(.show-clear) .autocomplete-clear-button.svelte-lduj97{display:none}.autocomplete.svelte-lduj97 select.svelte-lduj97{display:none}.autocomplete.is-multiple.svelte-lduj97 .input-container.svelte-lduj97{height:auto;box-shadow:inset 0 1px 2px rgba(10, 10, 10, 0.1);border-radius:4px;border:1px solid #b5b5b5;padding-left:0.4em;padding-right:0.4em;display:flex;flex-wrap:wrap;align-items:stretch;background-color:#fff}.autocomplete.is-multiple.svelte-lduj97 .tag.svelte-lduj97{display:flex;margin-top:0.5em;margin-bottom:0.3em}.autocomplete.is-multiple.svelte-lduj97 .tag.is-delete.svelte-lduj97{cursor:pointer}.autocomplete.is-multiple.svelte-lduj97 .tags.svelte-lduj97{margin-right:0.3em;margin-bottom:0}.autocomplete.is-multiple.svelte-lduj97 .autocomplete-input.svelte-lduj97{display:flex;width:100%;flex:1 1 50px;min-width:3em;border:none;box-shadow:none;background:none}',me(document.head,t)}var er=t=>({noResultsText:t[0]&2048}),Mi=t=>({noResultsText:t[11]}),tr=t=>({createText:t[0]&8192}),qi=t=>({createText:t[13]}),nr=t=>({loadingText:t[0]&4096}),Li=t=>({loadingText:t[12]});function Ri(t,e,n){let l=t.slice();return l[108]=e[n],l[110]=n,l}var lr=t=>({item:t[0]&134217728,label:t[0]&134217728}),zi=t=>({item:t[108].item,label:t[108].highlighted?t[108].highlighted:t[108].label});function Hi(t,e,n){let l=t.slice();return l[111]=e[n],l}var ir=t=>({label:t[0]&2,item:t[0]&2}),Pi=t=>({label:t[34](t[111]),item:t[111],unselectItem:t[41]});function Bi(t,e,n){let l=t.slice();return l[110]=e[n],l}function or(t){let e,n=t[1],l=[];for(let i=0;i<n.length;i+=1)l[i]=Qi(Bi(t,n,i));return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=Yt()},m(i,r){for(let o=0;o<l.length;o+=1)l[o].m(i,r);X(i,e,r)},p(i,r){if(r[0]&18|r[1]&8){n=i[1];let o;for(o=0;o<n.length;o+=1){let s=Bi(i,n,o);l[o]?l[o].p(s,r):(l[o]=Qi(s),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(i){Ml(l,i),i&&W(e)}}}function rr(t){let e,n;return{c(){e=ge("option"),n=pt(t[3]),e.__value=t[2],e.value=e.__value,e.selected=!0,P(e,"class","svelte-lduj97")},m(l,i){X(l,e,i),me(e,n)},p(l,i){i[0]&8&&an(n,l[3]),i[0]&4&&(e.__value=l[2],e.value=e.__value)},d(l){l&&W(e)}}}function Qi(t){let e,n=t[34](t[110])+"",l,i,r;return{c(){e=ge("option"),l=pt(n),i=Kt(),e.__value=r=t[4](t[110],!0),e.value=e.__value,e.selected=!0,P(e,"class","svelte-lduj97")},m(o,s){X(o,e,s),me(e,l),me(e,i)},p(o,s){s[0]&2&&n!==(n=o[34](o[110])+"")&&an(l,n),s[0]&18&&r!==(r=o[4](o[110],!0))&&(e.__value=r,e.value=e.__value)},d(o){o&&W(e)}}}function Gi(t){let e,n,l=t[1],i=[];for(let o=0;o<l.length;o+=1)i[o]=Ui(Hi(t,l,o));let r=o=>Ce(i[o],1,1,()=>{i[o]=null});return{c(){for(let o=0;o<i.length;o+=1)i[o].c();e=Yt()},m(o,s){for(let a=0;a<i.length;a+=1)i[a].m(o,s);X(o,e,s),n=!0},p(o,s){if(s[0]&2|s[1]&1032|s[2]&8192){l=o[1];let a;for(a=0;a<l.length;a+=1){let f=Hi(o,l,a);i[a]?(i[a].p(f,s),te(i[a],1)):(i[a]=Ui(f),i[a].c(),te(i[a],1),i[a].m(e.parentNode,e))}for(Sn(),a=l.length;a<i.length;a+=1)r(a);Fn()}},i(o){if(!n){for(let s=0;s<l.length;s+=1)te(i[s]);n=!0}},o(o){i=i.filter(Boolean);for(let s=0;s<i.length;s+=1)Ce(i[s]);n=!1},d(o){Ml(i,o),o&&W(e)}}}function ar(t){let e,n,l=t[34](t[111])+"",i,r,o,s,a,f;return{c(){e=ge("div"),n=ge("span"),i=pt(l),r=Kt(),o=ge("span"),s=Kt(),P(n,"class","tag svelte-lduj97"),P(o,"class","tag is-delete svelte-lduj97"),P(e,"class","tags has-addons svelte-lduj97")},m(u,d){X(u,e,d),me(e,n),me(n,i),me(e,r),me(e,o),X(u,s,d),a||(f=lt(o,"click",Uo(function(){Ti(t[41](t[111]))&&t[41](t[111]).apply(this,arguments)})),a=!0)},p(u,d){t=u,d[0]&2&&l!==(l=t[34](t[111])+"")&&an(i,l)},d(u){u&&W(e),u&&W(s),a=!1,f()}}}function Ui(t){let e,n=t[76].tag,l=qn(n,t,t[75],Pi),i=l||ar(t);return{c(){i&&i.c()},m(r,o){i&&i.m(r,o),e=!0},p(r,o){l?l.p&&o[0]&2|o[2]&8192&&Ln(l,n,r,r[75],o,ir,Pi):i&&i.p&&o[0]&2&&i.p(r,o)},i(r){e||(te(i,r),e=!0)},o(r){Ce(i,r),e=!1},d(r){i&&i.d(r)}}}function Ki(t){let e,n,l;return{c(){e=ge("span"),e.textContent="\u2716",P(e,"class","autocomplete-clear-button svelte-lduj97")},m(i,r){X(i,e,r),n||(l=lt(e,"click",t[45]),n=!0)},p:Nl,d(i){i&&W(e),n=!1,l()}}}function sr(t){let e,n,l=t[76]["no-results"],i=qn(l,t,t[75],Mi),r=i||dr(t);return{c(){e=ge("div"),r&&r.c(),P(e,"class","autocomplete-list-item-no-results svelte-lduj97")},m(o,s){X(o,e,s),r&&r.m(e,null),n=!0},p(o,s){i?i.p&&s[0]&2048|s[2]&8192&&Ln(i,l,o,o[75],s,er,Mi):r&&r.p&&s[0]&2048&&r.p(o,s)},i(o){n||(te(r,o),n=!0)},o(o){Ce(r,o),n=!1},d(o){o&&W(e),r&&r.d(o)}}}function ur(t){let e,n,l,i,r=t[76].create,o=qn(r,t,t[75],qi),s=o||mr(t);return{c(){e=ge("div"),s&&s.c(),P(e,"class","autocomplete-list-item-create svelte-lduj97")},m(a,f){X(a,e,f),s&&s.m(e,null),n=!0,l||(i=lt(e,"click",t[35]),l=!0)},p(a,f){o?o.p&&f[0]&8192|f[2]&8192&&Ln(o,r,a,a[75],f,tr,qi):s&&s.p&&f[0]&8192&&s.p(a,f)},i(a){n||(te(s,a),n=!0)},o(a){Ce(s,a),n=!1},d(a){a&&W(e),s&&s.d(a),l=!1,i()}}}function cr(t){let e,n,l=t[76].loading,i=qn(l,t,t[75],Li),r=i||pr(t);return{c(){e=ge("div"),r&&r.c(),P(e,"class","autocomplete-list-item-loading svelte-lduj97")},m(o,s){X(o,e,s),r&&r.m(e,null),n=!0},p(o,s){i?i.p&&s[0]&4096|s[2]&8192&&Ln(i,l,o,o[75],s,nr,Li):r&&r.p&&s[0]&4096&&r.p(o,s)},i(o){n||(te(r,o),n=!0)},o(o){Ce(r,o),n=!1},d(o){o&&W(e),r&&r.d(o)}}}function fr(t){let e,n,l,i=t[27],r=[];for(let a=0;a<i.length;a+=1)r[a]=Wi(Ri(t,i,a));let o=a=>Ce(r[a],1,1,()=>{r[a]=null}),s=t[5]>0&&t[27].length>t[5]&&Ji(t);return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Kt(),s&&s.c(),n=Yt()},m(a,f){for(let u=0;u<r.length;u+=1)r[u].m(a,f);X(a,e,f),s&&s.m(a,f),X(a,n,f),l=!0},p(a,f){if(f[0]&201326624|f[1]&32800|f[2]&8192){i=a[27];let u;for(u=0;u<i.length;u+=1){let d=Ri(a,i,u);r[u]?(r[u].p(d,f),te(r[u],1)):(r[u]=Wi(d),r[u].c(),te(r[u],1),r[u].m(e.parentNode,e))}for(Sn(),u=i.length;u<r.length;u+=1)o(u);Fn()}a[5]>0&&a[27].length>a[5]?s?s.p(a,f):(s=Ji(a),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(a){if(!l){for(let f=0;f<i.length;f+=1)te(r[f]);l=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)Ce(r[f]);l=!1},d(a){Ml(r,a),a&&W(e),s&&s.d(a),a&&W(n)}}}function dr(t){let e;return{c(){e=pt(t[11])},m(n,l){X(n,e,l)},p(n,l){l[0]&2048&&an(e,n[11])},d(n){n&&W(e)}}}function mr(t){let e;return{c(){e=pt(t[13])},m(n,l){X(n,e,l)},p(n,l){l[0]&8192&&an(e,n[13])},d(n){n&&W(e)}}}function pr(t){let e;return{c(){e=pt(t[12])},m(n,l){X(n,e,l)},p(n,l){l[0]&4096&&an(e,n[12])},d(n){n&&W(e)}}}function Yi(t){let e,n,l=t[108]&&Vi(t);return{c(){l&&l.c(),e=Yt()},m(i,r){l&&l.m(i,r),X(i,e,r),n=!0},p(i,r){i[108]?l?(l.p(i,r),r[0]&134217728&&te(l,1)):(l=Vi(i),l.c(),te(l,1),l.m(e.parentNode,e)):l&&(Sn(),Ce(l,1,1,()=>{l=null}),Fn())},i(i){n||(te(l),n=!0)},o(i){Ce(l),n=!1},d(i){l&&l.d(i),i&&W(e)}}}function Vi(t){let e,n,l,i,r,o=t[76].item,s=qn(o,t,t[75],zi),a=s||gr(t);function f(){return t[79](t[108])}function u(){return t[80](t[110])}return{c(){e=ge("div"),a&&a.c(),P(e,"class",n="autocomplete-list-item "+(t[110]===t[26]?"selected":"")+" svelte-lduj97"),In(e,"confirmed",t[46](t[108].item))},m(d,p){X(d,e,p),a&&a.m(e,null),l=!0,i||(r=[lt(e,"click",f),lt(e,"pointerenter",u)],i=!0)},p(d,p){t=d,s?s.p&&p[0]&134217728|p[2]&8192&&Ln(s,o,t,t[75],p,lr,zi):a&&a.p&&p[0]&134217728&&a.p(t,p),(!l||p[0]&67108864&&n!==(n="autocomplete-list-item "+(t[110]===t[26]?"selected":"")+" svelte-lduj97"))&&P(e,"class",n),p[0]&201326592|p[1]&32768&&In(e,"confirmed",t[46](t[108].item))},i(d){l||(te(a,d),l=!0)},o(d){Ce(a,d),l=!1},d(d){d&&W(e),a&&a.d(d),i=!1,rn(r)}}}function hr(t){let e,n=t[108].label+"",l;return{c(){l=Yt(),e=new ql(l)},m(i,r){e.m(n,i,r),X(i,l,r)},p(i,r){r[0]&134217728&&n!==(n=i[108].label+"")&&e.p(n)},d(i){i&&W(l),i&&e.d()}}}function _r(t){let e,n=t[108].highlighted+"",l;return{c(){l=Yt(),e=new ql(l)},m(i,r){e.m(n,i,r),X(i,l,r)},p(i,r){r[0]&134217728&&n!==(n=i[108].highlighted+"")&&e.p(n)},d(i){i&&W(l),i&&e.d()}}}function gr(t){let e;function n(r,o){return r[108].highlighted?_r:hr}let l=n(t),i=l(t);return{c(){i.c(),e=Yt()},m(r,o){i.m(r,o),X(r,e,o)},p(r,o){l===(l=n(r))&&i?i.p(r,o):(i.d(1),i=l(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){i.d(r),r&&W(e)}}}function Wi(t){let e,n,l=t[108]&&(t[5]<=0||t[110]<t[5])&&Yi(t);return{c(){l&&l.c(),e=Yt()},m(i,r){l&&l.m(i,r),X(i,e,r),n=!0},p(i,r){i[108]&&(i[5]<=0||i[110]<i[5])?l?(l.p(i,r),r[0]&134217760&&te(l,1)):(l=Yi(i),l.c(),te(l,1),l.m(e.parentNode,e)):l&&(Sn(),Ce(l,1,1,()=>{l=null}),Fn())},i(i){n||(te(l),n=!0)},o(i){Ce(l),n=!1},d(i){l&&l.d(i),i&&W(e)}}}function Ji(t){let e,n,l=t[27].length-t[5]+"",i,r;return{c(){e=ge("div"),n=pt("..."),i=pt(l),r=pt(" results not shown"),P(e,"class","autocomplete-list-item-no-results svelte-lduj97")},m(o,s){X(o,e,s),me(e,n),me(e,i),me(e,r)},p(o,s){s[0]&134217760&&l!==(l=o[27].length-o[5]+"")&&an(i,l)},d(o){o&&W(e)}}}function br(t){let e,n,l,i,r,o,s,a,f,u,d,p,y,C,I,G,se,L,U,N;function J(k,q){if(!k[6]&&k[2])return rr;if(k[6]&&k[1])return or}let R=J(t),K=R&&R(t),Y=t[6]&&t[1]&&Gi(t),B=t[32]&&Ki(t),ct=[fr,cr,ur,sr],V=[];function He(k,q){return k[27]&&k[27].length>0?0:k[30]&&k[12]?1:k[7]?2:k[11]?3:-1}return~(C=He(t))&&(I=V[C]=ct[C](t)),{c(){e=ge("div"),n=ge("select"),K&&K.c(),l=Kt(),i=ge("div"),Y&&Y.c(),r=Kt(),o=ge("input"),d=Kt(),B&&B.c(),p=Kt(),y=ge("div"),I&&I.c(),P(n,"name",t[19]),P(n,"id",t[20]),n.multiple=t[6],P(n,"class","svelte-lduj97"),P(o,"type","text"),P(o,"class",s=""+((t[16]?t[16]:"")+" input autocomplete-input svelte-lduj97")),P(o,"id",a=t[17]?t[17]:""),P(o,"autocomplete",f=t[22]?"on":"some-other-text"),P(o,"placeholder",t[14]),P(o,"name",t[18]),o.disabled=t[25],P(o,"title",t[21]),o.readOnly=u=t[23]||t[8]&&t[1],P(i,"class","input-container svelte-lduj97"),P(y,"class",G=""+((t[24]?t[24]:"")+" autocomplete-list "+(t[31]?"":"hidden")+`
    is-fullwidth svelte-lduj97`)),P(e,"class",se=""+((t[15]?t[15]:"")+`
  `+(t[9]||!t[0].length?"hide-arrow":"")+`
  `+(t[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+t[33]+" svelte-lduj97")),In(e,"show-clear",t[32]),In(e,"is-loading",t[10]&&t[30])},m(k,q){X(k,e,q),me(e,n),K&&K.m(n,null),me(e,l),me(e,i),Y&&Y.m(i,null),me(i,r),me(i,o),t[77](o),ji(o,t[3]),me(i,d),B&&B.m(i,null),me(e,p),me(e,y),~C&&V[C].m(y,null),t[81](y),L=!0,U||(N=[lt(window,"click",t[37]),lt(o,"input",t[78]),lt(o,"input",t[40]),lt(o,"focus",t[43]),lt(o,"blur",t[44]),lt(o,"keydown",t[38]),lt(o,"click",t[42]),lt(o,"keypress",t[39])],U=!0)},p(k,q){R===(R=J(k))&&K?K.p(k,q):(K&&K.d(1),K=R&&R(k),K&&(K.c(),K.m(n,null))),(!L||q[0]&524288)&&P(n,"name",k[19]),(!L||q[0]&1048576)&&P(n,"id",k[20]),(!L||q[0]&64)&&(n.multiple=k[6]),k[6]&&k[1]?Y?(Y.p(k,q),q[0]&66&&te(Y,1)):(Y=Gi(k),Y.c(),te(Y,1),Y.m(i,r)):Y&&(Sn(),Ce(Y,1,1,()=>{Y=null}),Fn()),(!L||q[0]&65536&&s!==(s=""+((k[16]?k[16]:"")+" input autocomplete-input svelte-lduj97")))&&P(o,"class",s),(!L||q[0]&131072&&a!==(a=k[17]?k[17]:""))&&P(o,"id",a),(!L||q[0]&4194304&&f!==(f=k[22]?"on":"some-other-text"))&&P(o,"autocomplete",f),(!L||q[0]&16384)&&P(o,"placeholder",k[14]),(!L||q[0]&262144)&&P(o,"name",k[18]),(!L||q[0]&33554432)&&(o.disabled=k[25]),(!L||q[0]&2097152)&&P(o,"title",k[21]),(!L||q[0]&8388866&&u!==(u=k[23]||k[8]&&k[1]))&&(o.readOnly=u),q[0]&8&&o.value!==k[3]&&ji(o,k[3]),k[32]?B?B.p(k,q):(B=Ki(k),B.c(),B.m(i,null)):B&&(B.d(1),B=null);let ot=C;C=He(k),C===ot?~C&&V[C].p(k,q):(I&&(Sn(),Ce(V[ot],1,1,()=>{V[ot]=null}),Fn()),~C?(I=V[C],I?I.p(k,q):(I=V[C]=ct[C](k),I.c()),te(I,1),I.m(y,null)):I=null),(!L||q[0]&16777216|q[1]&1&&G!==(G=""+((k[24]?k[24]:"")+" autocomplete-list "+(k[31]?"":"hidden")+`
    is-fullwidth svelte-lduj97`)))&&P(y,"class",G),(!L||q[0]&33345&&se!==(se=""+((k[15]?k[15]:"")+`
  `+(k[9]||!k[0].length?"hide-arrow":"")+`
  `+(k[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+k[33]+" svelte-lduj97")))&&P(e,"class",se),q[0]&33345|q[1]&2&&In(e,"show-clear",k[32]),q[0]&1073776193&&In(e,"is-loading",k[10]&&k[30])},i(k){L||(te(Y),te(I),L=!0)},o(k){Ce(Y),Ce(I),L=!1},d(k){k&&W(e),K&&K.d(),Y&&Y.d(),t[77](null),B&&B.d(),~C&&V[C].d(),t[81](null),U=!1,rn(N)}}}function Pl(t,e){typeof t!="function"&&console.error("Not a function: "+t+", argument: "+e);let n;try{n=t(e)}catch(i){console.warn("Error executing Autocomplete function on value: "+e+" function: "+t)}let l=n;return l==null&&(l=""),typeof l!="string"&&(l=l.toString()),l}function Bl(t,e){if(!t)return 0;let n=t.keywords,l=0;return e.forEach(i=>{n.includes(i)&&l++}),l}function yr(t,e,n){return Bl(e,n)-Bl(t,n)}function cl(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function vr(t,e,n){let l,i,{$$slots:r={},$$scope:o}=e,{items:s=[]}=e,{searchFunction:a=!1}=e,{labelFieldName:f=void 0}=e,{keywordsFieldName:u=f}=e,{valueFieldName:d=void 0}=e,{labelFunction:p=function(c){return c==null?"":f?c[f]:c}}=e,{keywordsFunction:y=function(c){return c==null?"":u?c[u]:p(c)}}=e,{valueFunction:C=function(c,w=!1){return c==null?c:!B||w?d?c[d]:c:c.map(S=>d?S[d]:S)}}=e,{keywordsCleanFunction:I=function(c){return c}}=e,{textCleanFunction:G=function(c){return c}}=e,{beforeChange:se=function(c,w){return!0}}=e,{onChange:L=function(c){}}=e,{onFocus:U=function(){}}=e,{onBlur:N=function(){}}=e,{onCreate:J=function(c){T&&console.log("onCreate: "+c)}}=e,{selectFirstIfEmpty:R=!1}=e,{minCharactersToSearch:K=1}=e,{maxItemsToShowInList:Y=0}=e,{multiple:B=!1}=e,{create:ct=!1}=e,{ignoreAccents:V=!0}=e,{matchAllKeywords:He=!0}=e,{sortByMatchedKeywords:k=!1}=e,{itemFilterFunction:q=void 0}=e,{itemSortFunction:ot=void 0}=e,{lock:Oe=!1}=e,{delay:rt=0}=e,{localFiltering:It=!0}=e,{hideArrow:Vt=!1}=e,{showClear:Ie=!1}=e,{showLoadingIndicator:Wt=!1}=e,{noResultsText:St="No results found"}=e,{loadingText:Ft="Loading results..."}=e,{createText:Jt="Not found, add anyway?"}=e,{placeholder:Pe=void 0}=e,{className:Zt=void 0}=e,{inputClassName:Ye=void 0}=e,{inputId:Ve=void 0}=e,{name:Xt=void 0}=e,{selectName:be=void 0}=e,{selectId:Se=void 0}=e,{title:Tt=void 0}=e,{html5autocomplete:xt=void 0}=e,{readonly:Z=void 0}=e,{dropdownClassName:$t=void 0}=e,{disabled:We=!1}=e,{debug:T=!1}=e,{selectedItem:H=B?[]:void 0}=e,{value:pe=void 0}=e,{highlightedItem:ye=void 0}=e,Et="sautocomplete-"+Math.floor(Math.random()*1e3),ue,Je,Ze=!1,_=!1,Q=-1,{text:ce}=e,Ne=0,ne,Be=[],Fe=0,fe=0,en;function un(c){return Pl(p,c)}function oe(c){let w=Pl(y,c),S=Pl(I,w);return S=S.toLowerCase().trim(),V&&(S=cl(S)),T&&console.log("Extracted keywords: '"+S+"' from item: "+JSON.stringify(c)),S}function cn(){let c;T&&(c=`Autocomplete prepare list ${Ve?`(id: ${Ve})`:""}`,console.time(c),console.log("Prepare items to search"),console.log("items: "+JSON.stringify(s))),Array.isArray(s)||(console.warn("Autocomplete items / search function did not return array but",s),n(0,s=[]));let w=s?s.length:0;Be=new Array(w),w>0&&s.forEach((S,z)=>{let le=ht(S);le==null&&console.log("Undefined item for: ",S),Be[z]=le}),T&&(console.log(Be.length+" items to search"),console.timeEnd(c))}function ht(c){return{keywords:oe(c),label:un(c),item:c}}function fn(){n(2,pe=C(H)),n(3,ce=B?"":un(H)),n(27,ne=Be),L(H)}function Pn(c){if(c==null)return"";let w=c.replace(/[&/\\#,+()$~%.'":*?<>{}]/g," ").trim();if(n(74,Ne=w.length),K>1&&Ne<K)return"";let z=G(w).toLowerCase().trim();return T&&console.log("Change user entered text '"+c+"' into '"+z+"'"),z}async function Me(){let c;T&&(c=`Autocomplete search ${Ve?`(id: ${Ve})`:""})`,console.time(c),console.log("Searching user entered text: '"+ce+"'"));let w=Pn(ce);if(w===""){a?(n(0,s=[]),T&&console.log("User entered text is empty clear list of items")):(n(27,ne=Be),T&&console.log("User entered text is empty set the list of items to all items")),jn(),T&&console.timeEnd(c);return}if(!a)jt(w);else{Fe=Fe+1;let S=Fe;if(n(30,_=!0),a.constructor.name==="AsyncGeneratorFunction"){for await(let z of a(w)){if(S<fe)return!1;S>fe&&n(0,s=[]),fe=S,n(0,s=[...s,...z]),jt(w)}fe<S&&(fe=S,n(0,s=[]),jt(w))}else{let z=await a(w);if(S<fe)return!1;fe=S,n(0,s=z),jt(w)}n(30,_=!1)}T&&(console.timeEnd(c),console.log("Search found "+ne.length+" items"))}function Xe(c,w){var S=Bl(c,w);return He?S>=w.length:S>0}function jt(c){cn();let S=(V?cl(c):c).split(/\s+/g),z;It?(q?z=Be.filter(at=>q(at.item,S)):z=Be.filter(at=>Xe(at,S)),ot?z=z.sort((at,re)=>ot(at.item,re.item,S)):k&&(z=z.sort((at,re)=>yr(at,re,S)))):z=Be;let le=Ke(S,"label"),yt=z.map(le);return n(27,ne=yt),jn(),!0}function ft(c){if(T&&console.log("selectListItem",c),typeof c=="undefined"&&ct){let S=J(ce);if(typeof S!="undefined"){cn(),n(27,ne=Be);let z=Ge(S,ne);z>=0&&(n(26,Q=z),c=ne[Q])}}if(typeof c=="undefined")return T&&console.log("listItem is undefined. Can not select."),!1;let w=c.item;return se(H,w)&&(B?H?H.includes(w)?n(1,H=H.filter(S=>S!==w)):n(1,H=[...H,w]):n(1,H=[w]):(n(1,H=void 0),n(1,H=w))),!0}function Dt(){T&&console.log("selectItem",Q);let c=ne[Q];ft(c)&&(Re(),B&&ue.focus())}function Tn(){T&&console.log("up"),At(),Q>0&&n(26,Q--,Q),Te()}function qe(){T&&console.log("down"),At(),Q<ne.length-1&&n(26,Q++,Q),Te()}function Te(){T&&console.log("highlight");let c=".selected";T&&console.log("Seaching DOM element: "+c+" in "+Je);let w=Je&&Je.querySelector(c);w?typeof w.scrollIntoViewIfNeeded=="function"?(T&&console.log("Scrolling selected item into view"),w.scrollIntoViewIfNeeded()):T&&console.warn("Could not scroll selected item into view, scrollIntoViewIfNeeded not supported"):T&&console.warn("Selected item not found to scroll into view")}function dn(c){T&&console.log("onListItemClick"),ft(c)&&(Re(),B&&ue.focus())}function _t(c){T&&console.log("onDocumentClick: "+JSON.stringify(c.composedPath())),c.composedPath().some(w=>w.classList&&w.classList.contains(Et))?(T&&console.log("onDocumentClick inside"),Te()):(T&&console.log("onDocumentClick outside"),Re())}function mn(c){T&&console.log("onKeyDown");let w=c.key;w==="Tab"&&c.shiftKey&&(w="ShiftTab");let z={Tab:Ze?qe.bind(this):null,ShiftTab:Ze?Tn.bind(this):null,ArrowDown:qe.bind(this),ArrowUp:Tn.bind(this),Escape:Qn.bind(this),Backspace:B&&H&&H.length&&!ce?gt.bind(this):null}[w];typeof z=="function"&&z(c)}function Bn(c){T&&console.log("onKeyPress"),c.key==="Enter"&&Ze&&(c.preventDefault(),Qe())}function Qe(){Dt()}function xe(c){T&&console.log("onInput"),n(3,ce=c.target.value),en&&clearTimeout(en),rt?en=setTimeout(En,rt):En()}function pn(c){T&&console.log("unselectItem",c),n(1,H=H.filter(w=>w!==c)),ue.focus()}function En(){Me()&&(n(26,Q=0),At())}function Ee(){T&&console.log("onInputClick"),Le()}function Qn(c){T&&console.log("onEsc"),c.stopPropagation(),Ze&&(ue.focus(),Re())}function gt(c){T&&console.log("onBackspace"),pn(H[H.length-1])}function hn(){T&&console.log("onFocus"),U(),Le()}function Gn(){T&&console.log("onBlur"),N()}function Le(){if(T&&console.log("resetListToAllItemsAndOpen"),ce?!Be.length&&H&&a&&Me():n(27,ne=Be),At(),H){T&&console.log("Searching currently selected item: "+JSON.stringify(H));let c=Ge(H,ne);c>=0&&(n(26,Q=c),Te())}}function Ge(c,w){T&&console.log("Finding index for item",c);let S=-1;for(let z=0;z<w.length;z++){let le=w[z];if(typeof le=="undefined"){T&&console.log(`listItem ${z} is undefined. Skipping.`);continue}if(T&&console.log("Item "+z+": "+JSON.stringify(le)),c==le.item){S=z;break}}return T&&(S>=0?console.log("Found index for item: "+S):console.warn("Not found index for item: "+c)),S}function At(){T&&console.log("open"),!tn()&&n(73,Ze=!0)}function Re(){T&&console.log("close"),n(73,Ze=!1),n(30,_=!1),!ce&&R&&(n(26,Q=0),Dt())}function tn(){return K>1&&Ne<K}function jn(){tn()&&Re()}function Ue(){T&&console.log("clear"),n(3,ce=""),n(1,H=B?[]:void 0),setTimeout(()=>{ue.focus(),Re()})}function Ke(c,w){return S=>{let z=S[w],le=Object.assign({highlighted:void 0},S);le.highlighted=z;let yt=z.toLowerCase(),at=V?cl(yt):yt;if(c&&c.length){let re=[];for(let he=0;he<c.length;he++){let ze=c[he];V&&(ze=cl(ze));let Ct=ze.length,ae=0;do if(ae=at.indexOf(ze,ae),ae>=0){let nn=ae+Ct;re.push([ae,nn]),ae=nn}while(ae!==-1)}if(re.length>0){let he=new Set;for(let ze=0;ze<re.length;ze++){let Ct=re[ze],ae=Ct[0],nn=Ct[1],vt=yt.substring(ae,nn);he.add(vt)}for(let ze of he){if(ze==="b")continue;let Ct=new RegExp("("+ze+")","ig"),ae=le.highlighted.replace(Ct,"<b>$1</b>");le.highlighted=ae}}}return le}}function Dn(c){return H?B?H.includes(c):c==H:!1}function Un(c){al[c?"unshift":"push"](()=>{ue=c,n(28,ue)})}function je(){ce=this.value,n(3,ce)}let Kn=c=>dn(c),bt=c=>{n(26,Q=c)};function _n(c){al[c?"unshift":"push"](()=>{Je=c,n(29,Je)})}return t.$$set=c=>{"items"in c&&n(0,s=c.items),"searchFunction"in c&&n(48,a=c.searchFunction),"labelFieldName"in c&&n(49,f=c.labelFieldName),"keywordsFieldName"in c&&n(50,u=c.keywordsFieldName),"valueFieldName"in c&&n(51,d=c.valueFieldName),"labelFunction"in c&&n(52,p=c.labelFunction),"keywordsFunction"in c&&n(53,y=c.keywordsFunction),"valueFunction"in c&&n(4,C=c.valueFunction),"keywordsCleanFunction"in c&&n(54,I=c.keywordsCleanFunction),"textCleanFunction"in c&&n(55,G=c.textCleanFunction),"beforeChange"in c&&n(56,se=c.beforeChange),"onChange"in c&&n(57,L=c.onChange),"onFocus"in c&&n(58,U=c.onFocus),"onBlur"in c&&n(59,N=c.onBlur),"onCreate"in c&&n(60,J=c.onCreate),"selectFirstIfEmpty"in c&&n(61,R=c.selectFirstIfEmpty),"minCharactersToSearch"in c&&n(62,K=c.minCharactersToSearch),"maxItemsToShowInList"in c&&n(5,Y=c.maxItemsToShowInList),"multiple"in c&&n(6,B=c.multiple),"create"in c&&n(7,ct=c.create),"ignoreAccents"in c&&n(63,V=c.ignoreAccents),"matchAllKeywords"in c&&n(64,He=c.matchAllKeywords),"sortByMatchedKeywords"in c&&n(65,k=c.sortByMatchedKeywords),"itemFilterFunction"in c&&n(66,q=c.itemFilterFunction),"itemSortFunction"in c&&n(67,ot=c.itemSortFunction),"lock"in c&&n(8,Oe=c.lock),"delay"in c&&n(68,rt=c.delay),"localFiltering"in c&&n(69,It=c.localFiltering),"hideArrow"in c&&n(9,Vt=c.hideArrow),"showClear"in c&&n(70,Ie=c.showClear),"showLoadingIndicator"in c&&n(10,Wt=c.showLoadingIndicator),"noResultsText"in c&&n(11,St=c.noResultsText),"loadingText"in c&&n(12,Ft=c.loadingText),"createText"in c&&n(13,Jt=c.createText),"placeholder"in c&&n(14,Pe=c.placeholder),"className"in c&&n(15,Zt=c.className),"inputClassName"in c&&n(16,Ye=c.inputClassName),"inputId"in c&&n(17,Ve=c.inputId),"name"in c&&n(18,Xt=c.name),"selectName"in c&&n(19,be=c.selectName),"selectId"in c&&n(20,Se=c.selectId),"title"in c&&n(21,Tt=c.title),"html5autocomplete"in c&&n(22,xt=c.html5autocomplete),"readonly"in c&&n(23,Z=c.readonly),"dropdownClassName"in c&&n(24,$t=c.dropdownClassName),"disabled"in c&&n(25,We=c.disabled),"debug"in c&&n(71,T=c.debug),"selectedItem"in c&&n(1,H=c.selectedItem),"value"in c&&n(2,pe=c.value),"highlightedItem"in c&&n(47,ye=c.highlightedItem),"text"in c&&n(3,ce=c.text),"$$scope"in c&&n(75,o=c.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&cn(),t.$$.dirty[0]&2&&fn(),t.$$.dirty[0]&201326592&&n(47,ye=ne&&Q&&Q>=0&&Q<ne.length?ne[Q].item:null),t.$$.dirty[0]&1|t.$$.dirty[2]&6144&&n(31,l=Ze&&(s&&s.length>0||Ne>0)),t.$$.dirty[0]&322|t.$$.dirty[2]&256&&n(32,i=Ie||(Oe||B)&&H)},[s,H,pe,ce,C,Y,B,ct,Oe,Vt,Wt,St,Ft,Jt,Pe,Zt,Ye,Ve,Xt,be,Se,Tt,xt,Z,$t,We,Q,ne,ue,Je,_,l,i,Et,un,Dt,dn,_t,mn,Bn,xe,pn,Ee,hn,Gn,Ue,Dn,ye,a,f,u,d,p,y,I,G,se,L,U,N,J,R,K,V,He,k,q,ot,rt,It,Ie,T,Ke,Ze,Ne,o,r,Un,je,Kn,bt,_n]}var Zi=class extends Ni{constructor(e){super();document.getElementById("svelte-lduj97-style")||$o(),xo(this,e,vr,br,Bo,{items:0,searchFunction:48,labelFieldName:49,keywordsFieldName:50,valueFieldName:51,labelFunction:52,keywordsFunction:53,valueFunction:4,keywordsCleanFunction:54,textCleanFunction:55,beforeChange:56,onChange:57,onFocus:58,onBlur:59,onCreate:60,selectFirstIfEmpty:61,minCharactersToSearch:62,maxItemsToShowInList:5,multiple:6,create:7,ignoreAccents:63,matchAllKeywords:64,sortByMatchedKeywords:65,itemFilterFunction:66,itemSortFunction:67,lock:8,delay:68,localFiltering:69,hideArrow:9,showClear:70,showLoadingIndicator:10,noResultsText:11,loadingText:12,createText:13,placeholder:14,className:15,inputClassName:16,inputId:17,name:18,selectName:19,selectId:20,title:21,html5autocomplete:22,readonly:23,dropdownClassName:24,disabled:25,debug:71,selectedItem:1,value:2,highlightedItem:47,text:3,highlightFilter:72},[-1,-1,-1,-1])}get highlightFilter(){return this.$$.ctx[72]}},it=Zi;function xi(t,e,n){let l=t.slice();return l[3]=e[n],l}function $i(t,e,n){let l=t.slice();return l[3]=e[n],l}function eo(t){let e,n,l=t[3].label+"",i,r,o,s,a;return{c(){e=b("li"),n=b("span"),i=F(l),r=D(),h(n,"class","svelte-8kv0mp"),h(e,"class",o=""+(vn(t[0]===t[3].value?"active":"")+" svelte-8kv0mp"))},m(f,u){j(f,e,u),m(e,n),m(n,i),m(e,r),s||(a=De(n,"click",function(){bn(t[2](t[3].value))&&t[2](t[3].value).apply(this,arguments)}),s=!0)},p(f,u){t=f,u&2&&l!==(l=t[3].label+"")&&ee(i,l),u&3&&o!==(o=""+(vn(t[0]===t[3].value?"active":"")+" svelte-8kv0mp"))&&h(e,"class",o)},d(f){f&&E(e),s=!1,a()}}}function to(t){let e,n,l,i;var r=t[3].component;function o(s){return{}}return r&&(n=new r(o(t))),{c(){e=b("div"),n&&we(n.$$.fragment),l=D(),h(e,"class","box svelte-8kv0mp")},m(s,a){j(s,e,a),n&&_e(n,e,null),m(e,l),i=!0},p(s,a){if(r!==(r=s[3].component)){if(n){ve();let f=n;M(f.$$.fragment,1,0,()=>{de(f,1)}),ke()}r?(n=new r(o(s)),we(n.$$.fragment),A(n.$$.fragment,1),_e(n,e,l)):n=null}},i(s){i||(n&&A(n.$$.fragment,s),i=!0)},o(s){n&&M(n.$$.fragment,s),i=!1},d(s){s&&E(e),n&&de(n)}}}function no(t){let e,n,l=t[0]==t[3].value&&to(t);return{c(){l&&l.c(),e=ln()},m(i,r){l&&l.m(i,r),j(i,e,r),n=!0},p(i,r){i[0]==i[3].value?l?(l.p(i,r),r&3&&A(l,1)):(l=to(i),l.c(),A(l,1),l.m(e.parentNode,e)):l&&(ve(),M(l,1,1,()=>{l=null}),ke())},i(i){n||(A(l),n=!0)},o(i){M(l),n=!1},d(i){l&&l.d(i),i&&E(e)}}}function wr(t){let e,n,l,i,r=t[1],o=[];for(let u=0;u<r.length;u+=1)o[u]=eo($i(t,r,u));let s=t[1],a=[];for(let u=0;u<s.length;u+=1)a[u]=no(xi(t,s,u));let f=u=>M(a[u],1,1,()=>{a[u]=null});return{c(){e=b("ul");for(let u=0;u<o.length;u+=1)o[u].c();n=D();for(let u=0;u<a.length;u+=1)a[u].c();l=ln(),h(e,"class","svelte-8kv0mp")},m(u,d){j(u,e,d);for(let p=0;p<o.length;p+=1)o[p].m(e,null);j(u,n,d);for(let p=0;p<a.length;p+=1)a[p].m(u,d);j(u,l,d),i=!0},p(u,[d]){if(d&7){r=u[1];let p;for(p=0;p<r.length;p+=1){let y=$i(u,r,p);o[p]?o[p].p(y,d):(o[p]=eo(y),o[p].c(),o[p].m(e,null))}for(;p<o.length;p+=1)o[p].d(1);o.length=r.length}if(d&3){s=u[1];let p;for(p=0;p<s.length;p+=1){let y=xi(u,s,p);a[p]?(a[p].p(y,d),A(a[p],1)):(a[p]=no(y),a[p].c(),A(a[p],1),a[p].m(l.parentNode,l))}for(ve(),p=s.length;p<a.length;p+=1)f(p);ke()}},i(u){if(!i){for(let d=0;d<s.length;d+=1)A(a[d]);i=!0}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)M(a[d]);i=!1},d(u){u&&E(e),Ut(o,u),u&&E(n),Ut(a,u),u&&E(l)}}}function Cr(t,e,n){let{items:l=[]}=e,{activeTabValue:i=1}=e,r=o=>()=>n(0,i=o);return t.$$set=o=>{"items"in o&&n(1,l=o.items),"activeTabValue"in o&&n(0,i=o.activeTabValue)},[i,l,r]}var lo=class extends ut{constructor(e){super();mt(this,e,Cr,wr,et,{items:1,activeTabValue:0})}},io=lo;Xi();function ro(t,e,n){let l=t.slice();return l[10]=e[n],l[12]=n,l}function Sr(t){let e;return{c(){e=b("li"),h(e,"class","svelte-gddmne")},m(n,l){j(n,e,l)},p:O,d(n){n&&E(e)}}}function Fr(t){let e,n,l,i=t[0][t[12]].data.name+"",r,o,s,a,f,u,d,p,y,C,I;function G(...U){return t[4](t[12],...U)}function se(...U){return t[5](t[12],...U)}function L(...U){return t[6](t[12],...U)}return{c(){e=b("li"),n=b("div"),l=b("span"),r=F(i),s=D(),a=b("div"),f=b("a"),f.innerHTML='<i class="fas fa-bullhorn svelte-gddmne"></i>',u=D(),d=b("a"),d.innerHTML='<i class="fas fa-pen svelte-gddmne"></i>',p=D(),y=b("a"),y.innerHTML='<i class="fas fa-trash svelte-gddmne"></i>',h(l,"class",o=""+(vn(t[0][t[12]].data.data.rarity)+" svelte-gddmne")),h(a,"class","right"),h(n,"class","flex svelte-gddmne"),h(e,"class","svelte-gddmne")},m(U,N){j(U,e,N),m(e,n),m(n,l),m(l,r),m(n,s),m(n,a),m(a,f),m(a,u),m(a,d),m(a,p),m(a,y),C||(I=[De(f,"click",G),De(d,"click",se),De(y,"click",L)],C=!0)},p(U,N){t=U,N&1&&i!==(i=t[0][t[12]].data.name+"")&&ee(r,i),N&1&&o!==(o=""+(vn(t[0][t[12]].data.data.rarity)+" svelte-gddmne"))&&h(l,"class",o)},d(U){U&&E(e),C=!1,$e(I)}}}function ao(t){let e;function n(r,o){return r[0][r[12]]?Fr:Sr}let l=n(t,-1),i=l(t);return{c(){i.c(),e=ln()},m(r,o){i.m(r,o),j(r,e,o)},p(r,o){l===(l=n(r,o))&&i?i.p(r,o):(i.d(1),i=l(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){i.d(r),r&&E(e)}}}function Tr(t){let e,n,l,i,r,o,s={length:12},a=[];for(let f=0;f<s.length;f+=1)a[f]=ao(ro(t,s,f));return{c(){e=b("ol");for(let f=0;f<a.length;f+=1)a[f].c();n=D(),l=b("li"),i=b("a"),i.innerHTML='<i class="fas fa-plus svelte-gddmne"></i>',h(i,"class","item-control item-create"),h(i,"title","Create item"),h(i,"data-type","item"),kn(l,"list-style-type","none"),kn(l,"text-align","right"),h(l,"class","svelte-gddmne"),h(e,"class","svelte-gddmne")},m(f,u){j(f,e,u);for(let d=0;d<a.length;d+=1)a[d].m(e,null);m(e,n),m(e,l),m(l,i),r||(o=De(i,"click",t[2]?._onItemCreate.bind(t[2])),r=!0)},p(f,[u]){if(u&5){s={length:12};let d;for(d=0;d<s.length;d+=1){let p=ro(f,s,d);a[d]?a[d].p(p,u):(a[d]=ao(p),a[d].c(),a[d].m(e,n))}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length}},i:O,o:O,d(f){f&&E(e),Ut(a,f),r=!1,o()}}}function Er(t,e,n){let l,i,r=wn("sheetStore");On(t,r,y=>n(3,i=y));let{actor:o,sheet:s}=i,a,f,u=(y,C)=>{s?._chatAbility(l[y].data._id)},d=(y,C)=>{s?._onItemEdit(l[y].data._id)},p=(y,C)=>{s?._onItemDelete(l[y].data._id)};return t.$$.update=()=>{if(t.$$.dirty&8){e:a=i.data}if(t.$$.dirty&8){e:n(0,l=i.data.data.itemTypes.item)}},[l,r,s,i,u,d,p]}var so=class extends ut{constructor(e){super();mt(this,e,Er,Tr,et,{})}},uo=so;oo();function fo(t,e,n){let l=t.slice();return l[10]=e[n],l[12]=n,l}function mo(t,e,n){let l=t.slice();return l[13]=e[n],l}function po(t){let e,n,l,i,r,o=t[13].data.data.cost+"",s,a=t[13].name+"",f,u,d,p,y,C,I,G;function se(...N){return t[4](t[13],...N)}function L(...N){return t[5](t[13],...N)}function U(...N){return t[6](t[13],...N)}return{c(){e=b("li"),n=b("div"),l=b("div"),i=b("a"),r=b("i"),s=F(o),f=F(a),u=D(),d=b("div"),p=b("a"),p.innerHTML='<i class="fas fa-info-circle svelte-17i6vo1"></i>',y=D(),C=b("a"),C.innerHTML='<i class="fas fa-trash svelte-17i6vo1"></i>',h(r,"class","cost svelte-17i6vo1"),h(d,"class","flex medium svelte-17i6vo1"),h(n,"class","flex svelte-17i6vo1"),h(e,"class","svelte-17i6vo1")},m(N,J){j(N,e,J),m(e,n),m(n,l),m(l,i),m(i,r),m(r,s),m(l,f),m(n,u),m(n,d),m(d,p),m(d,y),m(d,C),I||(G=[De(i,"click",se),De(p,"click",L),De(C,"click",U)],I=!0)},p(N,J){t=N,J&1&&o!==(o=t[13].data.data.cost+"")&&ee(s,o),J&1&&a!==(a=t[13].name+"")&&ee(f,a)},d(N){N&&E(e),I=!1,$e(G)}}}function ho(t){let e,n=Object.keys(t[0])[t[12]]+"",l,i,r,o,s=t[0][Object.keys(t[0])[t[12]]],a=[];for(let f=0;f<s.length;f+=1)a[f]=po(mo(t,s,f));return{c(){e=b("h3"),l=F(n),i=D(),r=b("ul");for(let f=0;f<a.length;f+=1)a[f].c();o=D(),h(e,"class","svelte-17i6vo1"),h(r,"class","svelte-17i6vo1")},m(f,u){j(f,e,u),m(e,l),j(f,i,u),j(f,r,u);for(let d=0;d<a.length;d+=1)a[d].m(r,null);m(r,o)},p(f,u){if(u&1&&n!==(n=Object.keys(f[0])[f[12]]+"")&&ee(l,n),u&5){s=f[0][Object.keys(f[0])[f[12]]];let d;for(d=0;d<s.length;d+=1){let p=mo(f,s,d);a[d]?a[d].p(p,u):(a[d]=po(p),a[d].c(),a[d].m(r,o))}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length}},d(f){f&&E(e),f&&E(i),f&&E(r),Ut(a,f)}}}function Dr(t){let e,n,l,i,r,o,s,a={length:Object.keys(t[0]).length},f=[];for(let u=0;u<a.length;u+=1)f[u]=ho(fo(t,a,u));return{c(){e=b("ul"),n=b("li"),l=b("a"),l.innerHTML='<i class="fas fa-plus svelte-17i6vo1"></i>',i=D();for(let u=0;u<f.length;u+=1)f[u].c();r=ln(),kn(n,"list-style-type","none"),kn(n,"text-align","right"),h(n,"class","svelte-17i6vo1"),h(e,"class","svelte-17i6vo1")},m(u,d){j(u,e,d),m(e,n),m(n,l),j(u,i,d);for(let p=0;p<f.length;p+=1)f[p].m(u,d);j(u,r,d),o||(s=De(l,"click",t[2]?._openAbilityDialog.bind(t[2])),o=!0)},p(u,[d]){if(d&5){a={length:Object.keys(u[0]).length};let p;for(p=0;p<a.length;p+=1){let y=fo(u,a,p);f[p]?f[p].p(y,d):(f[p]=ho(y),f[p].c(),f[p].m(r.parentNode,r))}for(;p<f.length;p+=1)f[p].d(1);f.length=a.length}},i:O,o:O,d(u){u&&E(e),u&&E(i),Ut(f,u),u&&E(r),o=!1,s()}}}function Ar(t,e,n){let l,i,r=wn("sheetStore");On(t,r,y=>n(3,i=y));let{actor:o,sheet:s}=i,a,f,u=(y,C)=>{s?._chatAbility(y.data._id)},d=(y,C)=>{s?._onItemEdit(y.data._id)},p=(y,C)=>{s?._onItemDelete(y.data._id)};return t.$$.update=()=>{if(t.$$.dirty&8){e:a=i.data}if(t.$$.dirty&8){e:n(0,l=i.data.data.abilityTypes)}},[l,r,s,i,u,d,p]}var _o=class extends ut{constructor(e){super();mt(this,e,Ar,Dr,et,{})}},go=_o;co();function Nr(t){let e,n=t[1].data.age+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.age+"")&&ee(l,n)},d(i){i&&E(e)}}}function Mr(t){let e,n,l;return{c(){e=b("input"),l=D(),h(e,"class","short svelte-bzv5hr"),h(e,"name","data.age"),h(e,"type","number"),e.value=n=t[1].data.age,h(e,"placeholder","Age")},m(i,r){j(i,e,r),j(i,l,r)},p(i,r){r[0]&2&&n!==(n=i[1].data.age)&&(e.value=n)},d(i){i&&E(e),i&&E(l)}}}function qr(t){let e,n=t[1].data.height+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.height+"")&&ee(l,n)},d(i){i&&E(e)}}}function Lr(t){let e,n;return{c(){e=b("input"),h(e,"class","medium svelte-bzv5hr"),h(e,"name","data.height"),h(e,"type","text"),e.value=n=t[1].data.height,h(e,"placeholder","Height")},m(l,i){j(l,e,i)},p(l,i){i[0]&2&&n!==(n=l[1].data.height)&&e.value!==n&&(e.value=n)},d(l){l&&E(e)}}}function Rr(t){let e,n=t[1].data.role+"",l,i;return{c(){e=b("strong"),l=F(n),i=D()},m(r,o){j(r,e,o),m(e,l),j(r,i,o)},p(r,o){o[0]&2&&n!==(n=r[1].data.role+"")&&ee(l,n)},i:O,o:O,d(r){r&&E(e),r&&E(i)}}}function zr(t){let e,n,l,i;function r(s){t[29](s)}let o={placeholder:"Role",items:t[2],inputClassName:"dotted medium",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[16],onChange:t[28]};return t[1].data.role!==void 0&&(o.selectedItem=t[1].data.role),e=new it({props:o}),Ae.push(()=>nt(e,"selectedItem",r)),{c(){we(e.$$.fragment),l=D()},m(s,a){_e(e,s,a),j(s,l,a),i=!0},p(s,a){let f={};a[0]&4&&(f.items=s[2]),!n&&a[0]&2&&(n=!0,f.selectedItem=s[1].data.role,tt(()=>n=!1)),e.$set(f)},i(s){i||(A(e.$$.fragment,s),i=!0)},o(s){M(e.$$.fragment,s),i=!1},d(s){de(e,s),s&&E(l)}}}function Hr(t){let e,n=t[1].data.featurebody+"",l,i;return{c(){e=b("strong"),l=F(n),i=D()},m(r,o){j(r,e,o),m(e,l),j(r,i,o)},p(r,o){o[0]&2&&n!==(n=r[1].data.featurebody+"")&&ee(l,n)},i:O,o:O,d(r){r&&E(e),r&&E(i)}}}function Pr(t){let e,n,l,i;function r(s){t[31](s)}let o={items:t[3],placeholder:"Body",inputClassName:"dotted long",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[15],onChange:t[30]};return t[1].data.featurebody!==void 0&&(o.selectedItem=t[1].data.featurebody),e=new it({props:o}),Ae.push(()=>nt(e,"selectedItem",r)),{c(){we(e.$$.fragment),l=D()},m(s,a){_e(e,s,a),j(s,l,a),i=!0},p(s,a){let f={};a[0]&8&&(f.items=s[3]),!n&&a[0]&2&&(n=!0,f.selectedItem=s[1].data.featurebody,tt(()=>n=!1)),e.$set(f)},i(s){i||(A(e.$$.fragment,s),i=!0)},o(s){M(e.$$.fragment,s),i=!1},d(s){de(e,s),s&&E(l)}}}function Br(t){let e,n=t[1].data.featureface+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.featureface+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function Qr(t){let e,n,l;function i(o){t[33](o)}let r={items:t[4],placeholder:"Face",inputClassName:"dotted long",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[17],onChange:t[32]};return t[1].data.featureface!==void 0&&(r.selectedItem=t[1].data.featureface),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&16&&(a.items=o[4]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.featureface,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function Gr(t){let e,n=t[1].data.featurevibe+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.featurevibe+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function Ur(t){let e,n,l;function i(o){t[35](o)}let r={items:t[5],inputClassName:"dotted long",placeholder:"Vibe",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[18],onChange:t[34]};return t[1].data.featurevibe!==void 0&&(r.selectedItem=t[1].data.featurevibe),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&32&&(a.items=o[5]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.featurevibe,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function Kr(t){let e,n=t[1].data.style1+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.style1+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function Yr(t){let e,n,l;function i(o){t[37](o)}let r={items:t[6],placeholder:"Outfit",inputClassName:"dotted long",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[19],onChange:t[36]};return t[1].data.style1!==void 0&&(r.selectedItem=t[1].data.style1),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&64&&(a.items=o[6]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.style1,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function Vr(t){let e,n=t[1].data.style2+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.style2+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function Wr(t){let e,n,l;function i(o){t[39](o)}let r={items:t[6],placeholder:"Outfit",inputClassName:"dotted long",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[19],onChange:t[38]};return t[1].data.style2!==void 0&&(r.selectedItem=t[1].data.style2),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&64&&(a.items=o[6]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.style2,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function Jr(t){let e,n=t[1].data.style3+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.style3+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function Zr(t){let e,n,l;function i(o){t[41](o)}let r={items:t[7],inputClassName:"dotted long",placeholder:"Movement",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[20],onChange:t[40]};return t[1].data.style3!==void 0&&(r.selectedItem=t[1].data.style3),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&128&&(a.items=o[7]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.style3,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function Xr(t){let e,n=t[1].data.home+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.home+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function xr(t){let e,n,l;function i(o){t[43](o)}let r={items:t[8],inputClassName:"dotted long",placeholder:"My Home",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[21],onChange:t[42]};return t[1].data.home!==void 0&&(r.selectedItem=t[1].data.home),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&256&&(a.items=o[8]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.home,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function $r(t){let e,n=t[1].data.community+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.community+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function ea(t){let e,n,l;function i(o){t[45](o)}let r={items:t[9],className:"verylong",inputClassName:"dotted",placeholder:"Legacy",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[24],onChange:t[44]};return t[1].data.community!==void 0&&(r.selectedItem=t[1].data.community),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&512&&(a.items=o[9]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.community,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function ta(t){let e,n=t[1].data.ideal+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.ideal+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function na(t){let e,n,l;function i(o){t[47](o)}let r={items:t[10],placeholder:"Ideal",inputClassName:"dotted long",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[22],onChange:t[46]};return t[1].data.ideal!==void 0&&(r.selectedItem=t[1].data.ideal),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&1024&&(a.items=o[10]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.ideal,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function la(t){let e,n=t[1].data.flaw+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.flaw+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function ia(t){let e,n,l;function i(o){t[49](o)}let r={items:t[11],inputClassName:"dotted long",placeholder:"Flaw",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[23],onChange:t[48]};return t[1].data.flaw!==void 0&&(r.selectedItem=t[1].data.flaw),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&2048&&(a.items=o[11]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.flaw,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function oa(t){let e,n=t[1].data.dream+"",l;return{c(){e=b("strong"),l=F(n)},m(i,r){j(i,e,r),m(e,l)},p(i,r){r[0]&2&&n!==(n=i[1].data.dream+"")&&ee(l,n)},i:O,o:O,d(i){i&&E(e)}}}function ra(t){let e,n,l;function i(o){t[51](o)}let r={items:t[12],className:"verylong",inputClassName:"dotted",placeholder:"My Dream",create:!0,createText:"Item doesn't exist, create one?",onCreate:t[24],onChange:t[50]};return t[1].data.dream!==void 0&&(r.selectedItem=t[1].data.dream),e=new it({props:r}),Ae.push(()=>nt(e,"selectedItem",i)),{c(){we(e.$$.fragment)},m(o,s){_e(e,o,s),l=!0},p(o,s){let a={};s[0]&4096&&(a.items=o[12]),!n&&s[0]&2&&(n=!0,a.selectedItem=o[1].data.dream,tt(()=>n=!1)),e.$set(a)},i(o){l||(A(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){de(e,o)}}}function aa(t){let e,n,l,i,r,o,s,a,f,u,d,p,y,C,I,G,se,L,U,N,J,R,K,Y,B,ct,V,He,k,q,ot,Oe,rt,It,Vt,Ie,Wt,St,Ft,Jt,Pe,Zt,Ye,Ve,Xt,be,Se,Tt,xt,Z,$t,We,T,H,pe,ye,Et,ue,Je,Ze,_,Q,ce,Ne,ne,Be,Fe,fe,en,un,oe,cn,ht,fn,Pn,Me,Xe,jt,ft,Dt,Tn,qe,Te,dn,_t,mn,Bn,Qe,xe,pn,En,Ee,Qn,gt,hn,Gn,Le,Ge,At,Re,tn,jn,Ue,Ke,Dn,Un,je,Kn,bt,_n,c,w,S,z,le,yt,at,re,he,ze,Ct,ae,nn,vt,Yn,Ul,st,dt,fl,Kl,Vn,Wn,gn,x,dl,Yl;function Vl(g,v){return g[13]?Mr:Nr}let Jn=Vl(t,[-1,-1]),kt=Jn(t);function Wl(g,v){return g[13]?Lr:qr}let Zn=Wl(t,[-1,-1]),wt=Zn(t),Jl=[zr,Rr],Ot=[];function Zl(g,v){return g[13]?0:1}be=Zl(t,[-1,-1]),Se=Ot[be]=Jl[be](t);let Xl=[Pr,Hr],Nt=[];function xl(g,v){return g[13]?0:1}pe=xl(t,[-1,-1]),ye=Nt[pe]=Xl[pe](t);let $l=[Qr,Br],Mt=[];function ei(g,v){return g[13]?0:1}_=ei(t,[-1,-1]),Q=Mt[_]=$l[_](t);let ti=[Ur,Gr],qt=[];function ni(g,v){return g[13]?0:1}Fe=ni(t,[-1,-1]),fe=qt[Fe]=ti[Fe](t);let li=[Yr,Kr],Lt=[];function ii(g,v){return g[13]?0:1}Me=ii(t,[-1,-1]),Xe=Lt[Me]=li[Me](t);let oi=[Wr,Vr],Rt=[];function ri(g,v){return g[13]?0:1}qe=ri(t,[-1,-1]),Te=Rt[qe]=oi[qe](t);let ai=[Zr,Jr],zt=[];function si(g,v){return g[13]?0:1}Qe=si(t,[-1,-1]),xe=zt[Qe]=ai[Qe](t);let ci=[xr,Xr],Ht=[];function fi(g,v){return g[13]?0:1}Le=fi(t,[-1,-1]),Ge=Ht[Le]=ci[Le](t);let di=[ea,$r],Pt=[];function mi(g,v){return g[13]?0:1}Ue=mi(t,[-1,-1]),Ke=Pt[Ue]=di[Ue](t);let pi=[na,ta],Bt=[];function hi(g,v){return g[13]?0:1}w=hi(t,[-1,-1]),S=Bt[w]=pi[w](t);let _i=[ia,la],Qt=[];function gi(g,v){return g[13]?0:1}re=gi(t,[-1,-1]),he=Qt[re]=_i[re](t);let bi=[ra,oa],Gt=[];function yi(g,v){return g[13]?0:1}return st=yi(t,[-1,-1]),dt=Gt[st]=bi[st](t),gn=new io({props:{items:t[25]}}),{c(){e=b("div"),n=b("div"),l=b("label"),l.textContent="HP:",i=D(),r=b("input"),s=F(" / 10"),a=D(),f=b("div"),u=b("a"),u.innerHTML='<i class="fas fa-dice-d20 fa-2x svelte-bzv5hr"></i>',d=D(),p=b("div"),y=b("label"),y.textContent="AP:",C=D(),I=b("input"),se=D(),L=b("div"),U=b("div"),N=b("content"),J=b("p"),R=b("img"),ct=F(`\r
                Hi, my name is\r
                `),V=b("input"),k=D(),q=b("br"),ot=F("("),Oe=b("input"),It=F(")."),Vt=D(),Ie=b("p"),Wt=F("I'm "),kt.c(),St=F(`. years old and\r
                stand\r
                `),wt.c(),Ft=F(`\r
                tall.`),Jt=D(),Pe=b("p"),Zt=F("I'm the party's "),Ye=b("input"),Xt=D(),Se.c(),Tt=F("."),xt=D(),Z=b("p"),$t=F("When people see me, they first notice my "),We=b("input"),H=D(),ye.c(),Et=F(`,\r
                `),ue=b("input"),Ze=D(),Q.c(),ce=F(`, and\r
                `),Ne=b("input"),Be=D(),fe.c(),en=F("."),un=D(),oe=b("p"),cn=F("I wear "),ht=b("input"),Pn=D(),Xe.c(),jt=F(`\r
                ,\r
                `),ft=b("input"),Tn=D(),Te.c(),dn=F(`\r
                , and move with\r
                `),_t=b("input"),Bn=D(),xe.c(),pn=F(`\r
                .`),En=D(),Ee=b("p"),Qn=F("I'm from "),gt=b("input"),Gn=D(),Ge.c(),At=F(`\r
                where my people are known for\r
                `),Re=b("input"),jn=D(),Ke.c(),Dn=F("."),Un=D(),je=b("p"),Kn=F("I believe in "),bt=b("input"),c=D(),S.c(),z=F(`\r
                , but my\r
                `),le=b("input"),at=D(),he.c(),ze=F(`\r
                side can get in the way.`),Ct=D(),ae=b("p"),nn=F("I dream of "),vt=b("input"),Ul=D(),dt.c(),fl=F(`\r
                .`),Kl=D(),Vn=b("div"),Wn=b("content"),we(gn.$$.fragment),h(l,"class","character-label"),h(l,"for","data.hp"),h(r,"type","number"),h(r,"class","hp svelte-bzv5hr"),h(r,"name","data.hp"),h(r,"data-dtype","Number"),r.value=o=t[1].data.hp,h(n,"class","hitpoints svelte-bzv5hr"),h(u,"class","svelte-bzv5hr"),h(f,"class","roll-generic svelte-bzv5hr"),h(y,"class","character-label"),h(y,"for","data.actionpoints"),h(I,"type","number"),h(I,"class","hp svelte-bzv5hr"),h(I,"name","data.ap"),h(I,"data-dtype","Number"),I.value=G=t[1].data.ap,h(p,"class","actionpoints svelte-bzv5hr"),h(e,"class","header flexrow svelte-bzv5hr"),h(R,"class","profile svelte-bzv5hr"),R.src!==(K=t[1].img)&&h(R,"src",K),h(R,"alt",Y=t[1].name),h(R,"data-edit","img"),h(R,"title",B=t[1].name),h(R,"align","left"),h(V,"class","name svelte-bzv5hr"),h(V,"name","name"),h(V,"type","text"),V.value=He=t[1].name,h(V,"placeholder","Name"),h(Oe,"class","medium svelte-bzv5hr"),h(Oe,"name","data.pronouns"),h(Oe,"type","text"),Oe.value=rt=t[1].data.pronouns,h(Oe,"placeholder","Pronouns"),h(J,"class","svelte-bzv5hr"),h(Ie,"class","svelte-bzv5hr"),h(Ye,"class","long svelte-bzv5hr"),h(Ye,"name","data.role"),h(Ye,"type","hidden"),Ye.value=Ve=t[1].data.role,h(Ye,"placeholder","Role"),h(Pe,"class","svelte-bzv5hr"),h(We,"class","long svelte-bzv5hr"),h(We,"name","data.featurebody"),h(We,"type","hidden"),We.value=T=t[1].data.featurebody,h(We,"placeholder","Body"),h(ue,"class","long svelte-bzv5hr"),h(ue,"name","data.featureface"),h(ue,"type","hidden"),ue.value=Je=t[1].data.featureface,h(ue,"placeholder","Face"),h(Ne,"class","long svelte-bzv5hr"),h(Ne,"name","data.featurevibe"),h(Ne,"type","hidden"),Ne.value=ne=t[1].data.featurevibe,h(Ne,"placeholder","Vibe"),h(Z,"class","svelte-bzv5hr"),h(ht,"class","long svelte-bzv5hr"),h(ht,"name","data.style1"),h(ht,"type","hidden"),ht.value=fn=t[1].data.style1,h(ht,"placeholder","Outfit"),h(ft,"class","long svelte-bzv5hr"),h(ft,"name","data.style2"),h(ft,"type","hidden"),ft.value=Dt=t[1].data.style2,h(ft,"placeholder","Outfit"),h(_t,"class","long svelte-bzv5hr"),h(_t,"name","data.style3"),h(_t,"type","hidden"),_t.value=mn=t[1].data.style3,h(_t,"placeholder","Movement"),h(oe,"class","svelte-bzv5hr"),h(gt,"class","long svelte-bzv5hr"),h(gt,"name","data.home"),h(gt,"type","hidden"),gt.value=hn=t[1].data.home,h(gt,"placeholder","My Home"),h(Re,"class","long svelte-bzv5hr"),h(Re,"name","data.community"),h(Re,"type","hidden"),Re.value=tn=t[1].data.community,h(Re,"placeholder",""),h(Ee,"class","svelte-bzv5hr"),h(bt,"class","long svelte-bzv5hr"),h(bt,"name","data.ideal"),h(bt,"type","hidden"),bt.value=_n=t[1].data.ideal,h(bt,"placeholder","my ideal"),h(le,"class","long svelte-bzv5hr"),h(le,"name","data.flaw"),h(le,"type","hidden"),le.value=yt=t[1].data.flaw,h(le,"placeholder","flaw"),h(je,"class","svelte-bzv5hr"),h(vt,"class","long svelte-bzv5hr"),h(vt,"name","data.dream"),h(vt,"type","hidden"),vt.value=Yn=t[1].data.dream,h(vt,"placeholder","my dream"),h(ae,"class","svelte-bzv5hr"),h(N,"class","svelte-bzv5hr"),h(U,"class","biography flexcol flex1 svelte-bzv5hr"),h(Wn,"class","svelte-bzv5hr"),h(Vn,"class","inventory-abilities flexcol flex1 svelte-bzv5hr"),h(L,"class","details flexrow flex2")},m(g,v){j(g,e,v),m(e,n),m(n,l),m(n,i),m(n,r),m(n,s),m(e,a),m(e,f),m(f,u),m(e,d),m(e,p),m(p,y),m(p,C),m(p,I),j(g,se,v),j(g,L,v),m(L,U),m(U,N),m(N,J),m(J,R),m(J,ct),m(J,V),m(J,k),m(J,q),m(J,ot),m(J,Oe),m(J,It),m(N,Vt),m(N,Ie),m(Ie,Wt),kt.m(Ie,null),m(Ie,St),wt.m(Ie,null),m(Ie,Ft),m(N,Jt),m(N,Pe),m(Pe,Zt),m(Pe,Ye),m(Pe,Xt),Ot[be].m(Pe,null),m(Pe,Tt),m(N,xt),m(N,Z),m(Z,$t),m(Z,We),m(Z,H),Nt[pe].m(Z,null),m(Z,Et),m(Z,ue),m(Z,Ze),Mt[_].m(Z,null),m(Z,ce),m(Z,Ne),m(Z,Be),qt[Fe].m(Z,null),m(Z,en),m(N,un),m(N,oe),m(oe,cn),m(oe,ht),m(oe,Pn),Lt[Me].m(oe,null),m(oe,jt),m(oe,ft),m(oe,Tn),Rt[qe].m(oe,null),m(oe,dn),m(oe,_t),m(oe,Bn),zt[Qe].m(oe,null),m(oe,pn),m(N,En),m(N,Ee),m(Ee,Qn),m(Ee,gt),m(Ee,Gn),Ht[Le].m(Ee,null),m(Ee,At),m(Ee,Re),m(Ee,jn),Pt[Ue].m(Ee,null),m(Ee,Dn),m(N,Un),m(N,je),m(je,Kn),m(je,bt),m(je,c),Bt[w].m(je,null),m(je,z),m(je,le),m(je,at),Qt[re].m(je,null),m(je,ze),m(N,Ct),m(N,ae),m(ae,nn),m(ae,vt),m(ae,Ul),Gt[st].m(ae,null),m(ae,fl),m(L,Kl),m(L,Vn),m(Vn,Wn),_e(gn,Wn,null),x=!0,dl||(Yl=[De(u,"click",t[14]?._rollDice.bind(t[14])),De(R,"click",t[26])],dl=!0)},p(g,v){(!x||v[0]&2&&o!==(o=g[1].data.hp))&&(r.value=o),(!x||v[0]&2&&G!==(G=g[1].data.ap))&&(I.value=G),(!x||v[0]&2&&R.src!==(K=g[1].img))&&h(R,"src",K),(!x||v[0]&2&&Y!==(Y=g[1].name))&&h(R,"alt",Y),(!x||v[0]&2&&B!==(B=g[1].name))&&h(R,"title",B),(!x||v[0]&2&&He!==(He=g[1].name)&&V.value!==He)&&(V.value=He),(!x||v[0]&2&&rt!==(rt=g[1].data.pronouns)&&Oe.value!==rt)&&(Oe.value=rt),Jn===(Jn=Vl(g,v))&&kt?kt.p(g,v):(kt.d(1),kt=Jn(g),kt&&(kt.c(),kt.m(Ie,St))),Zn===(Zn=Wl(g,v))&&wt?wt.p(g,v):(wt.d(1),wt=Zn(g),wt&&(wt.c(),wt.m(Ie,Ft))),(!x||v[0]&2&&Ve!==(Ve=g[1].data.role))&&(Ye.value=Ve);let ml=be;be=Zl(g,v),be===ml?Ot[be].p(g,v):(ve(),M(Ot[ml],1,1,()=>{Ot[ml]=null}),ke(),Se=Ot[be],Se?Se.p(g,v):(Se=Ot[be]=Jl[be](g),Se.c()),A(Se,1),Se.m(Pe,Tt)),(!x||v[0]&2&&T!==(T=g[1].data.featurebody))&&(We.value=T);let pl=pe;pe=xl(g,v),pe===pl?Nt[pe].p(g,v):(ve(),M(Nt[pl],1,1,()=>{Nt[pl]=null}),ke(),ye=Nt[pe],ye?ye.p(g,v):(ye=Nt[pe]=Xl[pe](g),ye.c()),A(ye,1),ye.m(Z,Et)),(!x||v[0]&2&&Je!==(Je=g[1].data.featureface))&&(ue.value=Je);let hl=_;_=ei(g,v),_===hl?Mt[_].p(g,v):(ve(),M(Mt[hl],1,1,()=>{Mt[hl]=null}),ke(),Q=Mt[_],Q?Q.p(g,v):(Q=Mt[_]=$l[_](g),Q.c()),A(Q,1),Q.m(Z,ce)),(!x||v[0]&2&&ne!==(ne=g[1].data.featurevibe))&&(Ne.value=ne);let _l=Fe;Fe=ni(g,v),Fe===_l?qt[Fe].p(g,v):(ve(),M(qt[_l],1,1,()=>{qt[_l]=null}),ke(),fe=qt[Fe],fe?fe.p(g,v):(fe=qt[Fe]=ti[Fe](g),fe.c()),A(fe,1),fe.m(Z,en)),(!x||v[0]&2&&fn!==(fn=g[1].data.style1))&&(ht.value=fn);let gl=Me;Me=ii(g,v),Me===gl?Lt[Me].p(g,v):(ve(),M(Lt[gl],1,1,()=>{Lt[gl]=null}),ke(),Xe=Lt[Me],Xe?Xe.p(g,v):(Xe=Lt[Me]=li[Me](g),Xe.c()),A(Xe,1),Xe.m(oe,jt)),(!x||v[0]&2&&Dt!==(Dt=g[1].data.style2))&&(ft.value=Dt);let bl=qe;qe=ri(g,v),qe===bl?Rt[qe].p(g,v):(ve(),M(Rt[bl],1,1,()=>{Rt[bl]=null}),ke(),Te=Rt[qe],Te?Te.p(g,v):(Te=Rt[qe]=oi[qe](g),Te.c()),A(Te,1),Te.m(oe,dn)),(!x||v[0]&2&&mn!==(mn=g[1].data.style3))&&(_t.value=mn);let yl=Qe;Qe=si(g,v),Qe===yl?zt[Qe].p(g,v):(ve(),M(zt[yl],1,1,()=>{zt[yl]=null}),ke(),xe=zt[Qe],xe?xe.p(g,v):(xe=zt[Qe]=ai[Qe](g),xe.c()),A(xe,1),xe.m(oe,pn)),(!x||v[0]&2&&hn!==(hn=g[1].data.home))&&(gt.value=hn);let vl=Le;Le=fi(g,v),Le===vl?Ht[Le].p(g,v):(ve(),M(Ht[vl],1,1,()=>{Ht[vl]=null}),ke(),Ge=Ht[Le],Ge?Ge.p(g,v):(Ge=Ht[Le]=ci[Le](g),Ge.c()),A(Ge,1),Ge.m(Ee,At)),(!x||v[0]&2&&tn!==(tn=g[1].data.community))&&(Re.value=tn);let kl=Ue;Ue=mi(g,v),Ue===kl?Pt[Ue].p(g,v):(ve(),M(Pt[kl],1,1,()=>{Pt[kl]=null}),ke(),Ke=Pt[Ue],Ke?Ke.p(g,v):(Ke=Pt[Ue]=di[Ue](g),Ke.c()),A(Ke,1),Ke.m(Ee,Dn)),(!x||v[0]&2&&_n!==(_n=g[1].data.ideal))&&(bt.value=_n);let wl=w;w=hi(g,v),w===wl?Bt[w].p(g,v):(ve(),M(Bt[wl],1,1,()=>{Bt[wl]=null}),ke(),S=Bt[w],S?S.p(g,v):(S=Bt[w]=pi[w](g),S.c()),A(S,1),S.m(je,z)),(!x||v[0]&2&&yt!==(yt=g[1].data.flaw))&&(le.value=yt);let Cl=re;re=gi(g,v),re===Cl?Qt[re].p(g,v):(ve(),M(Qt[Cl],1,1,()=>{Qt[Cl]=null}),ke(),he=Qt[re],he?he.p(g,v):(he=Qt[re]=_i[re](g),he.c()),A(he,1),he.m(je,ze)),(!x||v[0]&2&&Yn!==(Yn=g[1].data.dream))&&(vt.value=Yn);let Il=st;st=yi(g,v),st===Il?Gt[st].p(g,v):(ve(),M(Gt[Il],1,1,()=>{Gt[Il]=null}),ke(),dt=Gt[st],dt?dt.p(g,v):(dt=Gt[st]=bi[st](g),dt.c()),A(dt,1),dt.m(ae,fl))},i(g){x||(A(Se),A(ye),A(Q),A(fe),A(Xe),A(Te),A(xe),A(Ge),A(Ke),A(S),A(he),A(dt),A(gn.$$.fragment,g),x=!0)},o(g){M(Se),M(ye),M(Q),M(fe),M(Xe),M(Te),M(xe),M(Ge),M(Ke),M(S),M(he),M(dt),M(gn.$$.fragment,g),x=!1},d(g){g&&E(e),g&&E(se),g&&E(L),kt.d(),wt.d(),Ot[be].d(),Nt[pe].d(),Mt[_].d(),qt[Fe].d(),Lt[Me].d(),Rt[qe].d(),zt[Qe].d(),Ht[Le].d(),Pt[Ue].d(),Bt[w].d(),Qt[re].d(),Gt[st].d(),de(gn),dl=!1,$e(Yl)}}}function sa(t,e,n){let l,i=O,r=()=>(i(),i=yn(o,_=>n(27,l=_)),o);t.$$.on_destroy.push(()=>i());let{dataStore:o}=e;r(),Nn("sheetStore",o);let{actor:s,data:a,sheet:f}=l,u=["Fighter","Invoker","Ranger","Naturalist","Doctor","Spy","Magician","Wizard"],d=["scales","worn scars","iridescent skin","rack of muscles","towering physique","speckled complexion","barrel-sized belly","head of tentacles","generous curves","elongated limbs","bumpy exterior","willowy frame","sculpted hair","stout stature","lived-in body","vestigial tail","webbed fins","rough hide"],p=["gaunt face","sharp teeth","fulsome cheeks","large pointy ears","vestigial antennae","knee-length beard","devastating smile","windswept face","manicured fuzz","ridged forehead","triangular head","timeworn face","romantic eyes","severe jawline","skeptical eyes","radiant smile","burning eyes","heavy brows"],y=["long shadow","sleepy mood","sparkling gaze","eternal grimace","bursting energy","an air of mystery","gentle disposition","androgynous vibes","thousand-yard stare","tightly wound energy","brooding presence","friendly demeanor","meandering gaze","graceful posture","captivating grin","raucous laugh","flawless poise","fiery temper"],C=["tched leather armor","a billowing jumpsuit","a tightly fitted tunic","religious vestments","nicked chainmail","runes in my hair","a fluttering cape","weathered rags","a layered dress","a warm cloak","an owl pin","a charmed necklace","a ragged headcover","antique eyeglasses","a patterned hijab","a silken eyepatch","fingerless gloves","a quilted jacket","encrusted cuffs","a feathered cap","a boned bodice","a fancy hat","a bronze breastplate","oversized spectacles","a homemade charm","hammered earrings","an ornamented belt","a shining hauberk","an animal brooch","obsidian bracers","a symbol of god","a tarnished ring","a humble tunic"],I=["no sense of urgency","an effortless glide","frenzied footwork","a confident step","great difficulty","a reliable pace","wide-swinging arms","a spring in my step","a singularpurpose","no sense of space","music inmy feet","an uneven gait","a joyful whistle","relentless focus","casual swagger","apprehension","a heavy step","fearlessness"],G=["a great metropolis","a remote village","a frontier town","a lonely island","a capital city","a seastead","a remote stronghold","a traveling caravan","a hidden warren","a working farm","a roadside inn","a ship atsea","a place I can't name","a subterranean city","a forgotten nation","a mountain town","a city in the mist","a homestead"],se=["their steady pursuit of pleasure","their easy going temperament","their unhurried sense of time","treating strangers with love","restoring justice to the land","onceruling a vast empire","creating a worldwonder","enduring a great tragedy","theirneutral rationality","their warm hospitality","a culture of secrecy","non-hierarchical relationships","plainly stating their intentions","their sense of duty to each other ","resisting a brutal ruling order","creating historic works of art","strict adherence to the law","their commercial success","setting cultural trends","their tradition always","inventing the future","losing a great war"],L=["Order","Justice","Heroism","Compassion","Generosity","Pleasure","Pragmatism","Honor","Power","Salvation","The Ends"],U=["Fearful","Megalomaniac","Idiot","Impish","Oblivious","Thief","hedonist","liar","reckless","wrathful","vain"],N=["returning to my hometown as a renowned hero","freeing myself from agang that wants me dead","getting revengeon someone who wronged me","finding a corner of the world to make my own","publishing a book that's found in every home","sparking an idea that transforms the world","becoming the greatest scholarin my field","recovering a stolen artifact for my people","stealing from the rich togive to the poor","having my name spoken by my leader","meeting my parents for the first time","spreading my ideal across the land","overturning a corrupt government","producing a timeless work of art","becoming tremendously wealthy","finding thesource of eternal life","becoming a leaderof my nation","becoming a notorious gambler","making every stranger smile","becoming a master artisan","dying an honorable death","mapping the entir eworld","meeting the grim reaper","pullingoff the big score","traveling to the stars","becoming a celebrity","meeting my god(s)","killing my past"],J,R="",K=!0;a.data.dream==""&&(K=!0);function Y(_){return R="Creating "+_,d.unshift(_),n(3,d),_}function B(_){return R="Creating "+_,u.unshift(_),n(2,u),_}function ct(_){return R="Creating "+_,p.unshift(_),n(4,p),_}function V(_){return R="Creating "+_,y.unshift(_),n(5,y),_}function He(_){return R="Creating "+_,C.unshift(_),n(6,C),_}function k(_){return R="Creating "+_,I.unshift(_),n(7,I),_}function q(_){return R="Creating "+_,G.unshift(_),n(8,G),_}function ot(_){return R="Creating "+_,se.unshift(_),n(9,se),_}function Oe(_){return R="Creating "+_,L.unshift(_),n(10,L),_}function rt(_){return R="Creating "+_,U.unshift(_),n(11,U),_}function It(_){return R="Creating "+_,N.unshift(_),n(12,N),_}let Vt=[{label:"Inventory",value:1,component:uo},{label:"Abilities",value:2,component:go}],Ie=_=>{let Q=_.currentTarget.dataset.edit,ce=getProperty(a,Q);return new FilePicker({type:"image",current:ce,callback:ne=>{s.update({[Q]:ne})},top:f.position.top+40,left:f.position.left+10}).browse()},Wt=_=>{f?._onSubmit(new Event("submit"))};function St(_){t.$$.not_equal(a.data.role,_)&&(a.data.role=_,n(1,a),n(27,l))}let Ft=_=>{f?._onSubmit(new Event("submit"))};function Jt(_){t.$$.not_equal(a.data.featurebody,_)&&(a.data.featurebody=_,n(1,a),n(27,l))}let Pe=_=>{f?._onSubmit(new Event("submit"))};function Zt(_){t.$$.not_equal(a.data.featureface,_)&&(a.data.featureface=_,n(1,a),n(27,l))}let Ye=_=>{f?._onSubmit(new Event("submit"))};function Ve(_){t.$$.not_equal(a.data.featurevibe,_)&&(a.data.featurevibe=_,n(1,a),n(27,l))}let Xt=_=>{f?._onSubmit(new Event("submit"))};function be(_){t.$$.not_equal(a.data.style1,_)&&(a.data.style1=_,n(1,a),n(27,l))}let Se=_=>{f?._onSubmit(new Event("submit"))};function Tt(_){t.$$.not_equal(a.data.style2,_)&&(a.data.style2=_,n(1,a),n(27,l))}let xt=_=>{f?._onSubmit(new Event("submit"))};function Z(_){t.$$.not_equal(a.data.style3,_)&&(a.data.style3=_,n(1,a),n(27,l))}let $t=_=>{f?._onSubmit(new Event("submit"))};function We(_){t.$$.not_equal(a.data.home,_)&&(a.data.home=_,n(1,a),n(27,l))}let T=_=>{f?._onSubmit(new Event("submit"))};function H(_){t.$$.not_equal(a.data.community,_)&&(a.data.community=_,n(1,a),n(27,l))}let pe=_=>{f?._onSubmit(new Event("submit"))};function ye(_){t.$$.not_equal(a.data.ideal,_)&&(a.data.ideal=_,n(1,a),n(27,l))}let Et=_=>{f?._onSubmit(new Event("submit"))};function ue(_){t.$$.not_equal(a.data.flaw,_)&&(a.data.flaw=_,n(1,a),n(27,l))}let Je=_=>{f?._onSubmit(new Event("submit"))};function Ze(_){t.$$.not_equal(a.data.dream,_)&&(a.data.dream=_,n(1,a),n(27,l))}return t.$$set=_=>{"dataStore"in _&&r(n(0,o=_.dataStore))},t.$$.update=()=>{if(t.$$.dirty[0]&134217728){e:n(1,a=l.data)}},[o,a,u,d,p,y,C,I,G,se,L,U,N,K,f,Y,B,ct,V,He,k,q,Oe,rt,It,Vt,Ie,l,Wt,St,Ft,Jt,Pe,Zt,Ye,Ve,Xt,be,Se,Tt,xt,Z,$t,We,T,H,pe,ye,Et,ue,Je,Ze]}var yo=class extends ut{constructor(e){super();mt(this,e,sa,aa,et,{dataStore:0},[-1,-1])}},vo=yo;bo();var Ql=class extends ActorSheet{app=null;dataStore=null;static get defaultOptions(){return foundry.utils.mergeObject(super.defaultOptions,{classes:["quest","sheet","actor"],template:"systems/quest/templates/actor-sheetv2.html",width:850,height:740,tabs:[]})}getData(){let e=super.getData();return e.systemData=e.data.data,e.sheet=this,e}activateListeners(e){super.activateListeners(e),!!this.isEditable&&(e.find(".item-control").click(this._onItemControl.bind(this)),e.find(".items .rollable").on("click",this._onItemRoll.bind(this)))}_onItemControl(e){e.preventDefault();let n=e.currentTarget,l=n.closest(".item"),i=this.actor.items.get(l?.dataset.itemId);switch(n.dataset.action){case"create":return getDocumentClass("Item").create({name:"New Item",type:"item"},{parent:this.actor});case"edit":return i.sheet.render(!0);case"delete":return i.delete()}}_onItemRoll(e){let n=$(e.currentTarget),l=n.parents(".item"),i=this.actor.items.get(l.data("itemId"));return new Roll(n.data("roll"),this.actor.getRollData()).toMessage({user:game.user.id,speaker:ChatMessage.getSpeaker({actor:this.actor}),flavor:`<h2>${i.name}</h2><h3>${n.text()}</h3>`})}_getSubmitData(e){return super._getSubmitData(e)}async _updateActorAbility(e,n,l){await this.actor.updateEmbeddedDocuments("Item",[{_id:e,data:{[n]:l}}])}async _updateEmbededItem(e,n){await this.actor.updateEmbeddedDocuments("Item",[{_id:e,data:n}])}async _onItemEdit(e){return this.actor.items.get(e).sheet.render(!0)}async _onItemDelete(e){this.actor.items.get(e).delete(),this.render()}async _openAbilityDialog(){game.quest.AbilityDialog.showAbilityDialog(this.object.data.data.role)}async _onItemCreate(e){e.preventDefault();let n=e.currentTarget,l=n.dataset.type,i=duplicate(n.dataset),o={name:`New ${l.capitalize()}`,type:l,data:i};return o.data={rank:1},delete o.data.type,l=="item"&&Object(this.actor.itemTypes.item).length>=12?(ui.notifications.error(this.actor.name+" can not carry another item."),!1):await Item.create(o,{parent:this.actor}).then(s=>{s.sheet.render(!0)})}async _onDropItem(e,n){if(!this.actor.isOwner)return!1;let l=await Item.implementation.fromDropData(n),i=l.toObject(),r=this.actor;if(n.actorId===r.id||r.isToken&&n.tokenId===r.token.id)return this._onSortItem(e,i);if(Object(r.itemTypes.item).length>=12&&l.type=="item")ui.notifications.error(r.name+" can not carry another item.");else return this._onDropItemCreate(i)}async _rollDice(){let e=new game.quest.QuestRoll("1d20");await e.evaluate({async:!0}),e.toMessage({user:game.user.id,speaker:ChatMessage.getSpeaker({actor:this.actor})})}async _chatAbility(e){let n=this.actor.items.get(e),l="systems/quest/templates/chat/ability.html";(n.data.data.long_description==""||!n.data.data.long_description)&&(n.data.data.long_description=n.data.data.description);let i={ability:n.data,actor:this.actor.data},r=await renderTemplate(l,i),o={actor:this.actor._id,type:CONST.CHAT_MESSAGE_TYPES.OTHER,content:r,speaker:{actor:this.actor}};return ChatMessage.create(o)}render(e=!1,n={}){let l=this.getData();if(this.app!==null){let i=Application.RENDER_STATES;if(this._state==i.RENDERING||this._state==i.RENDERED){this.dataStore?.set(l);return}}return this._render(e,n).catch(i=>{i.message=`An error occurred while rendering ${this.constructor.name} ${this.appId}: ${i.message}`,console.error(i),this._state=Application.RENDER_STATES.ERROR}).then(i=>{this.dataStore=ol(l),this.app=new vo({target:this.element.find("form").get(0),props:{dataStore:this.dataStore}})}),n.editable=n.editable??this.object.isOwner,this.object.apps[this.appId]=this,this}close(e={}){return this.app!=null&&(this.app.$destroy(),this.app=null,this.dataStore=null),super.close(e)}};ko();function ca(t){let e;return{c(){e=F("Hello, My Name is _____________________")},m(n,l){j(n,e,l)},p:O,i:O,o:O,d(n){n&&E(e)}}}function fa(t,e,n){let l,i=O,r=()=>(i(),i=yn(o,u=>n(1,l=u)),o);t.$$.on_destroy.push(()=>i());let{dataStore:o}=e;r(),Nn("sheetStore",o);let{actor:s,data:a,sheet:f}=l;return t.$$set=u=>{"dataStore"in u&&r(n(0,o=u.dataStore))},[o]}var wo=class extends ut{constructor(e){super();mt(this,e,fa,ca,et,{dataStore:0})}},Co=wo;var da=class extends ActorSheet{app=null;dataStore=null;static get defaultOptions(){return foundry.utils.mergeObject(super.defaultOptions,{classes:["quest","sheet","actor"],template:"systems/quest/templates/actor-sheetv2.html",width:550,height:600,tabs:[]})}getData(){let e=super.getData();return e.systemData=e.data.data,e.sheet=this,e}activateListeners(e){super.activateListeners(e),!!this.isEditable&&(e.find(".item-control").click(this._onItemControl.bind(this)),e.find(".items .rollable").on("click",this._onItemRoll.bind(this)))}_onItemControl(e){e.preventDefault();let n=e.currentTarget,l=n.closest(".item"),i=this.actor.items.get(l?.dataset.itemId);switch(n.dataset.action){case"create":return getDocumentClass("Item").create({name:game.i18n.localize("QUEST.ItemNew"),type:"item"},{parent:this.actor});case"edit":return i.sheet.render(!0);case"delete":return i.delete()}}_onItemRoll(e){let n=$(e.currentTarget),l=n.parents(".item"),i=this.actor.items.get(l.data("itemId"));return new Roll(n.data("roll"),this.actor.getRollData()).toMessage({user:game.user.id,speaker:ChatMessage.getSpeaker({actor:this.actor}),flavor:`<h2>${i.name}</h2><h3>${n.text()}</h3>`})}_getSubmitData(e){return super._getSubmitData(e)}_setMouseDice(e){game.quest.RollCount=e,game.quest.updateDisplay(e)}async _updateActorAbility(e,n,l){await this.actor.updateEmbeddedDocuments("Item",[{_id:e,data:{[n]:l}}])}async _updateEmbededItem(e,n){await this.actor.updateEmbeddedDocuments("Item",[{_id:e,data:n}])}async _onItemDelete(e){this.actor.items.get(e).delete(),this.render()}async _onItemCreate(e){e.preventDefault();let n=e.currentTarget,l=n.dataset.type,i=duplicate(n.dataset),o={name:`New ${l.capitalize()}`,type:l,data:i};return o.data={rank:1},delete o.data.type,await Item.create(o,{parent:this.actor}).then(s=>{s.sheet.render(!0)})}render(e=!1,n={}){let l=this.getData();if(this.app!==null){let i=Application.RENDER_STATES;if(this._state==i.RENDERING||this._state==i.RENDERED){this.dataStore?.set(l);return}}return this._render(e,n).catch(i=>{i.message=`An error occurred while rendering ${this.constructor.name} ${this.appId}: ${i.message}`,console.error(i),this._state=Application.RENDER_STATES.ERROR}).then(i=>{this.dataStore=ol(l),this.app=new Co({target:this.element.find("form").get(0),props:{dataStore:this.dataStore}})}),n.editable=n.editable??this.object.isOwner,this.object.apps[this.appId]=this,this}close(e={}){return this.app!=null&&(this.app.$destroy(),this.app=null,this.dataStore=null),super.close(e)}};var Io=async function(){let t=["systems/quest/templates/parts/sheet-attributes.html","systems/quest/templates/parts/sheet-groups.html"];return loadTemplates(t)};async function So(t,e){let n=`const roll = new Roll("${t.roll}", actor ? actor.getRollData() : {});
  roll.toMessage({speaker, flavor: "${t.label}"});`,l=game.macros.entities.find(i=>i.name===item.label&&i.command===n);return l||(l=await Macro.create({name:t.label,type:"script",command:n,flags:{"quest.attrMacro":!0}})),game.user.assignHotbarMacro(l,e),!1}var zn=class extends Roll{constructor(...e){super(...e)}async render(e={}){e=foundry.utils.mergeObject({user:game.user.id,flavor:null,template:this.constructor.CHAT_TEMPLATE,blind:!1},e),this._evaluated||this.evaluate();let n=await ma(this,e);return renderTemplate(e.template,n)}};vi(zn,"CHAT_TEMPLATE","systems/quest/templates/dice/roll.html");var ma=async(t,e)=>{let n=e.isPrivate,l,i;return t.result=="20"?(l="Triumph",i="triumph"):t.result>11?(l="Success",i="success"):t.result>6?(l="Tough Choice",i="touch-choice"):t.result>1?(l="Failure",i="catastrophe"):(l="Catastrophe",i="catastrophe"),{formula:n?"???":t._formula,flavor:n?null:e.flavor,user:e.user,tooltip:n?"":await t.getTooltip(),result:n?"?":t.result,total:n?"?":t.total,outcome:n?"?":l,css:n?"?":i}};var Hn=class extends Dialog{constructor(e){super(e);this.data={},this.data.title=e?.title??"Ability Browser",this.data.buttons={close:{label:"Close",callback:()=>{}}},this.data.default="close"}static get defaultOptions(){return foundry.utils.mergeObject(super.defaultOptions,{template:"systems/quest/templates/role-ability.html",resizable:!0,jQuery:!0,width:"710",height:"760",close:()=>{ui.notify}})}async _getContent(e){e||(e="Spy");let l=await(await game.packs.get("world.role-abilities")).getDocuments(),i=[...new Set(l.map(u=>u.data.data.role))],r=l.filter(u=>u.data.type=="ability"&&u.data.data.role===e),o=await r.filter(u=>u.data.type=="ability"&&u.data.data.quickstart==!0&&u.data.data.role===e);r.sort((u,d)=>String(u.data.data.path).localeCompare(d.data.data.path)||String(u.data.data.order).localeCompare(d.data.data.order));let s=r.reduce(function(u,d){let p=[];return u[d.data.data.path]=u[d.data.data.path]||[],u[d.data.data.path].push(d),u},Object.create(null)),a=[];for(let u=0;u<Object.keys(s).length;u++){let d={};d.name=Object.keys(s)[u],d.data=Object(s[Object.keys(s)[u]]),a.push(d)}return a.sort(function(u,d){return u.name==d.name?0:u.name=="Legendary"?1:d.name=="Legendary"||u.name<d.name?-1:u.name>d.name?1:0}),{role:e,abilities:a,quickStart:o,roleList:i}}static async showAbilityDialog(e){let n=new Hn,l=await n._getContent(e);n.data.content=l,n.Dialog=n,n.render(!0)}async _updateContent(e){let n=await this._getContent(e.currentTarget.value);this.Dialog.data.content=n,this.Dialog.render(!0)}_scrollTo(e){e.preventDefault();let l=e.currentTarget.dataset.target;$(".window-content").animate({scrollTop:$.find("#"+l)[0].offsetTop-$.find("#"+l)[0].scrollHeight-10},600)}activateListeners(e){super.activateListeners(e),e.find("#displayrole").change(this._updateContent.bind(this)),e.find(".paths").click(this._scrollTo.bind(this))}};var Gl=class{static async findCompendium(){return!!await game.packs.get("world.role-abilities")}static async getCompendium(){return await game.packs.get("world.role-abilities")}static async getSystemCompendium(){return await game.packs.get("quest.role-abilities")}static async createCompenium(){return await this.findCompendium()==!1?(ui.notifications.info("Importing Role Abiltiies into an editable world compendium. This should only take a moment."),(await this.getSystemCompendium()).duplicateCompendium({label:"Role Abilities"})):!1}};Hooks.once("init",async function(){console.log("Initializing Quest Quest System");let t=0;game.quest={QuestActor:xn,createQuestMacro:So,QuestRoll:zn,AbilityDialog:Hn,CompendiumImportHelper:Gl},CONFIG.Actor.documentClass=xn,CONFIG.Item.documentClass=Sl,CONFIG.Dice.rolls.push(zn),CONFIG.Combat.initiative={formula:"1d20",decimals:2},Actors.unregisterSheet("core",ActorSheet),Actors.registerSheet("quest",Ql,{makeDefault:!0}),Items.unregisterSheet("core",ItemSheet),Items.registerSheet("quest",Fl,{makeDefault:!0}),Items.registerSheet("quest",Tl,{types:["ability"],makeDefault:!0}),game.settings.register("quest","macroShorthand",{name:"SETTINGS.QuestMacroShorthandN",hint:"SETTINGS.QuestMacroShorthandL",scope:"world",type:Boolean,default:!0,config:!0}),game.settings.register("quest","initFormula",{name:"SETTINGS.QuestInitFormulaN",hint:"SETTINGS.QuestInitFormulaL",scope:"world",type:String,default:"1d20",config:!0,onChange:l=>n(l,!0)});let e=game.settings.get("quest","initFormula");n(e);function n(l,i=!1){if(!Roll.validate(l)){i&&ui.notifications.error(`${game.i18n.localize("QUEST.NotifyInitFormulaInvalid")}: ${l}`);return}CONFIG.Combat.initiative.formula=l}await Io(),TextEditor.enrichHTML=function(l,{secrets:i=!1,documents:r=!0,links:o=!0,rolls:s=!0,cost:a=!0,damage:f=!0,rollData:u,...d}={}){let p=document.createElement("div");p.innerHTML=String(l||""),i||p.querySelectorAll("section.secret").forEach(G=>G.parentNode.removeChild(G));let y=!0,C=[];if(d.entities&&(console.warn("The 'entities' option for TextEditor.enrichHTML is deprecated. Please use 'documents' instead."),r=d.entities),r){y&&(C=this._getTextNodes(p));let I=CONST.DOCUMENT_LINK_TYPES.concat("Compendium"),G=new RegExp(`@(${I.join("|")})\\[([^\\]]+)\\](?:{([^}]+)})?`,"g");y=this._replaceTextContent(C,G,this._createContentLink)}if(o){y&&(C=this._getTextNodes(p));let I=/(https?:\/\/)(www\.)?([^\s<]+)/gi;y=this._replaceTextContent(C,I,this._createHyperlink)}if(s){u=u instanceof Function?u():u||{},y&&(C=this._getTextNodes(p));let I=/\[\[(\/[a-zA-Z]+\s)?(.*?)([\]]{2,3})(?:{([^}]+)})?/gi;y=this._replaceTextContent(C,I,(...G)=>this._createInlineRoll(...G,u))}if(a){y&&(C=this._getTextNodes(p));let I=new RegExp("@(cost|Cost)\\[([^\\]]+)\\](?:{([^}]+)})?","g");y=this._replaceTextContent(C,I,this._createCost)}if(f){y&&(C=this._getTextNodes(p));let I=new RegExp("@(damage|Damage)\\[([^\\]]+)\\](?:{([^}]+)})?","g");y=this._replaceTextContent(C,I,this._createDamage)}return p.innerHTML},TextEditor._createCost=function(l){let i=document.createElement("a");return l=l.substring(6,l.length-1),i.innerHTML='<i class="cost">'+l+"</i>",i},TextEditor._createDamage=function(l){let i=document.createElement("a");return console.log(l),l=l.substring(8,l.length-1),i.innerHTML='<i class="damage">'+l+"</i>",i}});Hooks.once("ready",async()=>{await game.quest.CompendiumImportHelper.createCompenium()&&ui.notifications.info("Importing Complete.")});Handlebars.registerHelper("times",function(t,e){for(var n="",l=0;l<t;++l)n+=e.fn(l);return n});Handlebars.registerHelper("concat",function(){var t="";for(var e in arguments)typeof arguments[e]!="object"&&(t+=arguments[e]);return t});Handlebars.registerHelper("enrich",function(){var t=TextEditor.enrichHTML(arguments[0]);return t});Handlebars.registerHelper("enrich_stripcost",function(){var t=arguments[0];let e=new RegExp("@(cost|Cost)\\[([^\\]]+)\\](?:{([^}]+)})?","g");var t=t.replace(e,"");t=t.replace(/<p[^>]*>/g,"");var n=TextEditor.enrichHTML(t);return n});Handlebars.registerHelper("cost",function(){var t=TextEditor.enrichHTML("@cost["+arguments[0]+"]");return t});Handlebars.registerHelper("abilityLink",function(t,e,n){var l=TextEditor.enrichHTML("@"+e+"["+n+"]{"+t+"}");return l});Handlebars.registerHelper("replace",function(t,e,n){return t.replace(e,n)});Handlebars.registerHelper("slugify",function(t){return t.slugify({strict:!0})});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
//# sourceMappingURL=quest.js.map
